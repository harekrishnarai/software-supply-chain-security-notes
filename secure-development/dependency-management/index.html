<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A comprehensive resource for understanding and implementing software supply chain security."><meta name=author content="Hare Krishna Rai"><link href=../../risk-assessment/vulnerability-management/ rel=prev><link href=../sbom/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>Dependency Management - Software Supply Chain Security Notes</title><link rel=stylesheet href=../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../assets/extra.css><link rel=stylesheet href=../../assets/header-style.css><link rel=stylesheet href=../../assets/visibility-fix.css><link rel=stylesheet href=../../assets/home-style.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=deep-orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#dependency-management-in-software-development class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Software Supply Chain Security Notes" class="md-header__button md-logo" aria-label="Software Supply Chain Security Notes" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 19h1a1 1 0 0 1 1 1h7v2h-7a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1H2v-2h7a1 1 0 0 1 1-1h1v-1.66C8.07 16.13 6 13 6 9.67v-4L12 3l6 2.67v4c0 3.33-2.07 6.46-5 7.67zM12 5 8 6.69V10h4zm0 5v6c1.91-.47 4-2.94 4-5v-1z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Software Supply Chain Security Notes </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Dependency Management </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=deep-orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 6c1.4 0 2.8 1.1 2.8 2.5V11c.6 0 1.2.6 1.2 1.3v3.5c0 .6-.6 1.2-1.3 1.2H9.2c-.6 0-1.2-.6-1.2-1.3v-3.5c0-.6.6-1.2 1.2-1.2V9.5C9.2 8.1 10.6 7 12 7m0 1.2c-.8 0-1.5.5-1.5 1.3V11h3V9.5c0-.8-.7-1.3-1.5-1.3"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=cyan data-md-color-accent=deep-orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 11c0 5.55-3.84 10.74-9 12-5.16-1.26-9-6.45-9-12V5l9-4 9 4zm-9 10c3.75-1 7-5.46 7-9.78V6.3l-7-3.12L5 6.3v4.92C5 15.54 8.25 20 12 21m2.8-10V9.5C14.8 8.1 13.4 7 12 7S9.2 8.1 9.2 9.5V11c-.6 0-1.2.6-1.2 1.2v3.5c0 .7.6 1.3 1.2 1.3h5.5c.7 0 1.3-.6 1.3-1.2v-3.5c0-.7-.6-1.3-1.2-1.3m-1.3 0h-3V9.5c0-.8.7-1.3 1.5-1.3s1.5.5 1.5 1.3z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/harekrishnarai/software-supply-chain-security-notes title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../introduction/overview/ class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=../../risk-assessment/threat-modeling/ class=md-tabs__link> Risk Assessment </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Secure Development </a> </li> <li class=md-tabs__item> <a href=../../ci-cd-security/pipeline-security/ class=md-tabs__link> CI/CD Security </a> </li> <li class=md-tabs__item> <a href=../../tools/scanners/ class=md-tabs__link> Tools </a> </li> <li class=md-tabs__item> <a href=../../best-practices/standards/ class=md-tabs__link> Best Practices </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Software Supply Chain Security Notes" class="md-nav__button md-logo" aria-label="Software Supply Chain Security Notes" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 19h1a1 1 0 0 1 1 1h7v2h-7a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1H2v-2h7a1 1 0 0 1 1-1h1v-1.66C8.07 16.13 6 13 6 9.67v-4L12 3l6 2.67v4c0 3.33-2.07 6.46-5 7.67zM12 5 8 6.69V10h4zm0 5v6c1.91-.47 4-2.94 4-5v-1z"/></svg> </a> Software Supply Chain Security Notes </label> <div class=md-nav__source> <a href=https://github.com/harekrishnarai/software-supply-chain-security-notes title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Introduction </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Introduction </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../introduction/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../introduction/terminology/ class=md-nav__link> <span class=md-ellipsis> Terminology </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Risk Assessment </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Risk Assessment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../risk-assessment/threat-modeling/ class=md-nav__link> <span class=md-ellipsis> Threat Modeling </span> </a> </li> <li class=md-nav__item> <a href=../../risk-assessment/vulnerability-management/ class=md-nav__link> <span class=md-ellipsis> Vulnerability Management </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Secure Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Secure Development </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Dependency Management </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Dependency Management </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#understanding-dependencies class=md-nav__link> <span class=md-ellipsis> Understanding Dependencies </span> </a> <nav class=md-nav aria-label="Understanding Dependencies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#types-of-dependencies class=md-nav__link> <span class=md-ellipsis> Types of Dependencies </span> </a> </li> <li class=md-nav__item> <a href=#the-dependency-risk-landscape class=md-nav__link> <span class=md-ellipsis> The Dependency Risk Landscape </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-dependency-related-attacks class=md-nav__link> <span class=md-ellipsis> Common Dependency-Related Attacks </span> </a> <nav class=md-nav aria-label="Common Dependency-Related Attacks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dependency-confusion class=md-nav__link> <span class=md-ellipsis> Dependency Confusion </span> </a> </li> <li class=md-nav__item> <a href=#typosquatting class=md-nav__link> <span class=md-ellipsis> Typosquatting </span> </a> </li> <li class=md-nav__item> <a href=#compromised-maintainer-accounts class=md-nav__link> <span class=md-ellipsis> Compromised Maintainer Accounts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vulnerability-management class=md-nav__link> <span class=md-ellipsis> Vulnerability Management </span> </a> </li> <li class=md-nav__item> <a href=#best-practices-for-dependency-management class=md-nav__link> <span class=md-ellipsis> Best Practices for Dependency Management </span> </a> <nav class=md-nav aria-label="Best Practices for Dependency Management"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-inventory-and-selection class=md-nav__link> <span class=md-ellipsis> 1. Inventory and Selection </span> </a> </li> <li class=md-nav__item> <a href=#2-version-control-and-pinning class=md-nav__link> <span class=md-ellipsis> 2. Version Control and Pinning </span> </a> </li> <li class=md-nav__item> <a href=#3-monitoring-and-updates class=md-nav__link> <span class=md-ellipsis> 3. Monitoring and Updates </span> </a> </li> <li class=md-nav__item> <a href=#4-risk-reduction-strategies class=md-nav__link> <span class=md-ellipsis> 4. Risk Reduction Strategies </span> </a> </li> <li class=md-nav__item> <a href=#5-advanced-techniques class=md-nav__link> <span class=md-ellipsis> 5. Advanced Techniques </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#language-specific-tools-and-practices class=md-nav__link> <span class=md-ellipsis> Language-Specific Tools and Practices </span> </a> <nav class=md-nav aria-label="Language-Specific Tools and Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nodejs-javascript class=md-nav__link> <span class=md-ellipsis> Node.js / JavaScript </span> </a> </li> <li class=md-nav__item> <a href=#python class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=#java-maven class=md-nav__link> <span class=md-ellipsis> Java / Maven </span> </a> </li> <li class=md-nav__item> <a href=#go class=md-nav__link> <span class=md-ellipsis> Go </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-dependency-management-strategies class=md-nav__link> <span class=md-ellipsis> Advanced Dependency Management Strategies </span> </a> <nav class=md-nav aria-label="Advanced Dependency Management Strategies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dependency-confusion-prevention class=md-nav__link> <span class=md-ellipsis> Dependency Confusion Prevention </span> </a> </li> <li class=md-nav__item> <a href=#dependency-verification-and-attestation class=md-nav__link> <span class=md-ellipsis> Dependency Verification and Attestation </span> </a> </li> <li class=md-nav__item> <a href=#dependency-firewall-architecture class=md-nav__link> <span class=md-ellipsis> Dependency Firewall Architecture </span> </a> </li> <li class=md-nav__item> <a href=#dependency-risk-scoring-and-prioritization class=md-nav__link> <span class=md-ellipsis> Dependency Risk Scoring and Prioritization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dependency-management-implementation-guide class=md-nav__link> <span class=md-ellipsis> Dependency Management Implementation Guide </span> </a> <nav class=md-nav aria-label="Dependency Management Implementation Guide"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-dependency-inventory-and-classification class=md-nav__link> <span class=md-ellipsis> Step 1: Dependency Inventory and Classification </span> </a> </li> <li class=md-nav__item> <a href=#step-2-dependency-security-baseline class=md-nav__link> <span class=md-ellipsis> Step 2: Dependency Security Baseline </span> </a> </li> <li class=md-nav__item> <a href=#step-3-dependency-policy-development class=md-nav__link> <span class=md-ellipsis> Step 3: Dependency Policy Development </span> </a> </li> <li class=md-nav__item> <a href=#step-4-automated-dependency-update-strategy class=md-nav__link> <span class=md-ellipsis> Step 4: Automated Dependency Update Strategy </span> </a> </li> <li class=md-nav__item> <a href=#step-5-dependency-monitoring-and-incident-response class=md-nav__link> <span class=md-ellipsis> Step 5: Dependency Monitoring and Incident Response </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#specialized-dependency-management-approaches class=md-nav__link> <span class=md-ellipsis> Specialized Dependency Management Approaches </span> </a> <nav class=md-nav aria-label="Specialized Dependency Management Approaches"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#monorepo-dependency-management class=md-nav__link> <span class=md-ellipsis> Monorepo Dependency Management </span> </a> </li> <li class=md-nav__item> <a href=#microservice-dependency-management class=md-nav__link> <span class=md-ellipsis> Microservice Dependency Management </span> </a> </li> <li class=md-nav__item> <a href=#air-gapped-environment-dependency-management class=md-nav__link> <span class=md-ellipsis> Air-gapped Environment Dependency Management </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dependency-management-maturity-model class=md-nav__link> <span class=md-ellipsis> Dependency Management Maturity Model </span> </a> <nav class=md-nav aria-label="Dependency Management Maturity Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#level-5-optimizing-practices class=md-nav__link> <span class=md-ellipsis> Level 5 (Optimizing) Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> Conclusion </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../sbom/ class=md-nav__link> <span class=md-ellipsis> SBOM </span> </a> </li> <li class=md-nav__item> <a href=../secure-coding/ class=md-nav__link> <span class=md-ellipsis> Secure Coding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> CI/CD Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> CI/CD Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ci-cd-security/pipeline-security/ class=md-nav__link> <span class=md-ellipsis> Pipeline Security </span> </a> </li> <li class=md-nav__item> <a href=../../ci-cd-security/artifact-signing/ class=md-nav__link> <span class=md-ellipsis> Artifact Signing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/scanners/ class=md-nav__link> <span class=md-ellipsis> Scanners </span> </a> </li> <li class=md-nav__item> <a href=../../tools/monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Best Practices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Best Practices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../best-practices/standards/ class=md-nav__link> <span class=md-ellipsis> Standards </span> </a> </li> <li class=md-nav__item> <a href=../../best-practices/frameworks/ class=md-nav__link> <span class=md-ellipsis> Frameworks </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#understanding-dependencies class=md-nav__link> <span class=md-ellipsis> Understanding Dependencies </span> </a> <nav class=md-nav aria-label="Understanding Dependencies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#types-of-dependencies class=md-nav__link> <span class=md-ellipsis> Types of Dependencies </span> </a> </li> <li class=md-nav__item> <a href=#the-dependency-risk-landscape class=md-nav__link> <span class=md-ellipsis> The Dependency Risk Landscape </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-dependency-related-attacks class=md-nav__link> <span class=md-ellipsis> Common Dependency-Related Attacks </span> </a> <nav class=md-nav aria-label="Common Dependency-Related Attacks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dependency-confusion class=md-nav__link> <span class=md-ellipsis> Dependency Confusion </span> </a> </li> <li class=md-nav__item> <a href=#typosquatting class=md-nav__link> <span class=md-ellipsis> Typosquatting </span> </a> </li> <li class=md-nav__item> <a href=#compromised-maintainer-accounts class=md-nav__link> <span class=md-ellipsis> Compromised Maintainer Accounts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vulnerability-management class=md-nav__link> <span class=md-ellipsis> Vulnerability Management </span> </a> </li> <li class=md-nav__item> <a href=#best-practices-for-dependency-management class=md-nav__link> <span class=md-ellipsis> Best Practices for Dependency Management </span> </a> <nav class=md-nav aria-label="Best Practices for Dependency Management"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-inventory-and-selection class=md-nav__link> <span class=md-ellipsis> 1. Inventory and Selection </span> </a> </li> <li class=md-nav__item> <a href=#2-version-control-and-pinning class=md-nav__link> <span class=md-ellipsis> 2. Version Control and Pinning </span> </a> </li> <li class=md-nav__item> <a href=#3-monitoring-and-updates class=md-nav__link> <span class=md-ellipsis> 3. Monitoring and Updates </span> </a> </li> <li class=md-nav__item> <a href=#4-risk-reduction-strategies class=md-nav__link> <span class=md-ellipsis> 4. Risk Reduction Strategies </span> </a> </li> <li class=md-nav__item> <a href=#5-advanced-techniques class=md-nav__link> <span class=md-ellipsis> 5. Advanced Techniques </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#language-specific-tools-and-practices class=md-nav__link> <span class=md-ellipsis> Language-Specific Tools and Practices </span> </a> <nav class=md-nav aria-label="Language-Specific Tools and Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nodejs-javascript class=md-nav__link> <span class=md-ellipsis> Node.js / JavaScript </span> </a> </li> <li class=md-nav__item> <a href=#python class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=#java-maven class=md-nav__link> <span class=md-ellipsis> Java / Maven </span> </a> </li> <li class=md-nav__item> <a href=#go class=md-nav__link> <span class=md-ellipsis> Go </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-dependency-management-strategies class=md-nav__link> <span class=md-ellipsis> Advanced Dependency Management Strategies </span> </a> <nav class=md-nav aria-label="Advanced Dependency Management Strategies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dependency-confusion-prevention class=md-nav__link> <span class=md-ellipsis> Dependency Confusion Prevention </span> </a> </li> <li class=md-nav__item> <a href=#dependency-verification-and-attestation class=md-nav__link> <span class=md-ellipsis> Dependency Verification and Attestation </span> </a> </li> <li class=md-nav__item> <a href=#dependency-firewall-architecture class=md-nav__link> <span class=md-ellipsis> Dependency Firewall Architecture </span> </a> </li> <li class=md-nav__item> <a href=#dependency-risk-scoring-and-prioritization class=md-nav__link> <span class=md-ellipsis> Dependency Risk Scoring and Prioritization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dependency-management-implementation-guide class=md-nav__link> <span class=md-ellipsis> Dependency Management Implementation Guide </span> </a> <nav class=md-nav aria-label="Dependency Management Implementation Guide"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-dependency-inventory-and-classification class=md-nav__link> <span class=md-ellipsis> Step 1: Dependency Inventory and Classification </span> </a> </li> <li class=md-nav__item> <a href=#step-2-dependency-security-baseline class=md-nav__link> <span class=md-ellipsis> Step 2: Dependency Security Baseline </span> </a> </li> <li class=md-nav__item> <a href=#step-3-dependency-policy-development class=md-nav__link> <span class=md-ellipsis> Step 3: Dependency Policy Development </span> </a> </li> <li class=md-nav__item> <a href=#step-4-automated-dependency-update-strategy class=md-nav__link> <span class=md-ellipsis> Step 4: Automated Dependency Update Strategy </span> </a> </li> <li class=md-nav__item> <a href=#step-5-dependency-monitoring-and-incident-response class=md-nav__link> <span class=md-ellipsis> Step 5: Dependency Monitoring and Incident Response </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#specialized-dependency-management-approaches class=md-nav__link> <span class=md-ellipsis> Specialized Dependency Management Approaches </span> </a> <nav class=md-nav aria-label="Specialized Dependency Management Approaches"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#monorepo-dependency-management class=md-nav__link> <span class=md-ellipsis> Monorepo Dependency Management </span> </a> </li> <li class=md-nav__item> <a href=#microservice-dependency-management class=md-nav__link> <span class=md-ellipsis> Microservice Dependency Management </span> </a> </li> <li class=md-nav__item> <a href=#air-gapped-environment-dependency-management class=md-nav__link> <span class=md-ellipsis> Air-gapped Environment Dependency Management </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dependency-management-maturity-model class=md-nav__link> <span class=md-ellipsis> Dependency Management Maturity Model </span> </a> <nav class=md-nav aria-label="Dependency Management Maturity Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#level-5-optimizing-practices class=md-nav__link> <span class=md-ellipsis> Level 5 (Optimizing) Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> Conclusion </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=dependency-management-in-software-development>Dependency Management in Software Development<a class=headerlink href=#dependency-management-in-software-development title="Permanent link">&para;</a></h1> <div class=secure-component> <span class="security-badge badge-warning">HIGH RISK AREA</span> Dependency management represents one of the highest-risk areas in the modern software supply chain. This guide provides comprehensive strategies to mitigate dependency-related risks. </div> <p>Managing dependencies securely is a critical aspect of software development, particularly in the context of software supply chain security. This document outlines best practices and guidelines for effectively managing dependencies to minimize risks.</p> <h2 id=understanding-dependencies>Understanding Dependencies<a class=headerlink href=#understanding-dependencies title="Permanent link">&para;</a></h2> <p>Dependencies are external libraries or packages that your software relies on to function. While they can significantly speed up development, they also introduce potential vulnerabilities if not managed properly.</p> <pre class=mermaid><code>graph TD
    classDef direct fill:#6ab04c, stroke:#333, stroke-width:1px, color:white
    classDef transitive fill:#f9ca24, stroke:#333, stroke-width:1px, color:black
    classDef vulnerable fill:#eb4d4b, stroke:#333, stroke-width:2px, color:white

    A[Your Application]:::direct --&gt; B[Direct Dependency A]:::direct
    A --&gt; C[Direct Dependency B]:::direct
    A --&gt; D[Direct Dependency C]:::direct

    B --&gt; E[Transitive Dependency X]:::transitive
    B --&gt; F[Transitive Dependency Y]:::vulnerable
    C --&gt; G[Transitive Dependency Z]:::transitive
    D --&gt; F
    G --&gt; H[Deeply Nested Dependency]:::transitive

    click F href "#vulnerability-management" "This dependency has known vulnerabilities"</code></pre> <h3 id=types-of-dependencies>Types of Dependencies<a class=headerlink href=#types-of-dependencies title="Permanent link">&para;</a></h3> <ol> <li><strong>Direct Dependencies</strong>: Libraries that are explicitly included in your project.</li> <li><strong>Transitive Dependencies</strong>: Libraries that your direct dependencies rely on (dependencies of dependencies).</li> <li><strong>Development Dependencies</strong>: Libraries used only during development, not in production.</li> <li><strong>Runtime Dependencies</strong>: Libraries required during execution of your application.</li> <li><strong>Peer Dependencies</strong>: Libraries that your package expects to be provided by the consumer.</li> </ol> <h3 id=the-dependency-risk-landscape>The Dependency Risk Landscape<a class=headerlink href=#the-dependency-risk-landscape title="Permanent link">&para;</a></h3> <p>Software dependencies introduce several categories of risk:</p> <table> <thead> <tr> <th>Risk Category</th> <th>Description</th> <th>Examples</th> <th>Impact</th> </tr> </thead> <tbody> <tr> <td><strong>Security Vulnerabilities</strong></td> <td>Flaws in dependencies that can be exploited</td> <td>SQL injection, buffer overflow, command injection</td> <td>High - can lead to data breaches, system compromise</td> </tr> <tr> <td><strong>Maintenance Issues</strong></td> <td>Abandoned or poorly maintained packages</td> <td>Outdated libraries, unmaintained code</td> <td>Medium - leads to technical debt and future security issues</td> </tr> <tr> <td><strong>Supply Chain Attacks</strong></td> <td>Malicious code intentionally introduced</td> <td>Typosquatting, dependency confusion, account takeover</td> <td>Critical - direct insertion of backdoors or malware</td> </tr> <tr> <td><strong>Licensing Compliance</strong></td> <td>Incompatible or restrictive licenses</td> <td>GPL violations, improper attribution</td> <td>Medium - legal and compliance issues</td> </tr> <tr> <td><strong>Operational Stability</strong></td> <td>Breaking changes, performance issues</td> <td>API changes, regression bugs</td> <td>Medium - application instability</td> </tr> </tbody> </table> <h2 id=common-dependency-related-attacks>Common Dependency-Related Attacks<a class=headerlink href=#common-dependency-related-attacks title="Permanent link">&para;</a></h2> <h3 id=dependency-confusion>Dependency Confusion<a class=headerlink href=#dependency-confusion title="Permanent link">&para;</a></h3> <p>Dependency confusion is an attack where a malicious package with the same name as an internal/private package is published to a public repository with a higher version number. When the build system looks for the "latest" version, it finds and installs the malicious package instead of the legitimate internal one.</p> <pre class=mermaid><code>sequenceDiagram
    participant Attacker
    participant Public as Public Repository
    participant Private as Private Repository
    participant Build as Build System

    Note over Private: Contains internal package "company-ui" v1.0.0
    Attacker-&gt;&gt;Public: Publish malicious "company-ui" v2.0.0
    Build-&gt;&gt;Public: Search for latest "company-ui"
    Public-&gt;&gt;Build: Return "company-ui" v2.0.0 (malicious)
    Build-&gt;&gt;Build: Install malicious package
    Note over Build: Attacker's code now executes in build environment</code></pre> <h3 id=typosquatting>Typosquatting<a class=headerlink href=#typosquatting title="Permanent link">&para;</a></h3> <p>Attackers publish malicious packages with names similar to popular packages, hoping that developers will accidentally install them through typographical errors (e.g., "lodahs" instead of "lodash").</p> <h3 id=compromised-maintainer-accounts>Compromised Maintainer Accounts<a class=headerlink href=#compromised-maintainer-accounts title="Permanent link">&para;</a></h3> <p>If an attacker gains access to a package maintainer's account, they can publish malicious versions of legitimate, widely used packages.</p> <h2 id=vulnerability-management>Vulnerability Management<a class=headerlink href=#vulnerability-management title="Permanent link">&para;</a></h2> <p>Vulnerability management for dependencies involves:</p> <ol> <li><strong>Identification</strong>: Discovering vulnerabilities in your dependencies</li> <li><strong>Assessment</strong>: Evaluating the risk and impact of the vulnerability</li> <li><strong>Remediation</strong>: Updating or replacing vulnerable dependencies</li> <li><strong>Verification</strong>: Ensuring vulnerabilities are properly addressed</li> </ol> <pre class=mermaid><code>graph TB
    classDef process fill:#3498db, stroke:#333, stroke-width:1px, color:white
    classDef decision fill:#e74c3c, stroke:#333, stroke-width:1px, color:white
    classDef action fill:#2ecc71, stroke:#333, stroke-width:1px, color:white

    A[Vulnerability Detected]:::process --&gt; B{Is it a False Positive?}:::decision
    B --&gt;|Yes| C[Document and Skip]:::action
    B --&gt;|No| D{Is it Exploitable?}:::decision

    D --&gt;|Yes, Critical| E[Immediate Update]:::action
    D --&gt;|Yes, Medium| F[Schedule Update]:::action
    D --&gt;|No, but fix available| G[Include in Regular Updates]:::action
    D --&gt;|No fix available| H[Apply Mitigation]:::action

    E --&gt; I[Verify Fix]:::process
    F --&gt; I
    G --&gt; I
    H --&gt; I

    I --&gt; J[Update SBOM]:::action</code></pre> <h2 id=best-practices-for-dependency-management>Best Practices for Dependency Management<a class=headerlink href=#best-practices-for-dependency-management title="Permanent link">&para;</a></h2> <h3 id=1-inventory-and-selection>1. Inventory and Selection<a class=headerlink href=#1-inventory-and-selection title="Permanent link">&para;</a></h3> <ul> <li><strong>Use Trusted Sources</strong>: Always source dependencies from reputable and trusted repositories. Avoid using unverified or unknown sources.</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Configure npm to use only approved registries</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>npm<span class=w> </span>config<span class=w> </span><span class=nb>set</span><span class=w> </span>registry<span class=w> </span>https://registry.npmjs.org/
</span></code></pre></div> <ul> <li><strong>Evaluate Before Adding</strong>: Before adding a new dependency, evaluate its:</li> <li>Maintenance status and update frequency</li> <li>Community adoption and activity</li> <li>Security track record</li> <li>Size and impact on your application</li> <li> <p>Available alternatives</p> </li> <li> <p><strong>Prefer Established Libraries</strong>: When possible, use well-maintained, popular libraries that have undergone significant security scrutiny.</p> </li> </ul> <h3 id=2-version-control-and-pinning>2. Version Control and Pinning<a class=headerlink href=#2-version-control-and-pinning title="Permanent link">&para;</a></h3> <ul> <li><strong>Lock Dependency Versions</strong>: Use lock files (e.g., <code>package-lock.json</code>, <code>yarn.lock</code>, <code>Pipfile.lock</code>, <code>poetry.lock</code>) to ensure consistent installations across different environments.</li> </ul> <div class="language-json highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1>// Example package-lock.json snippet</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=nt>&quot;lodash&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>  </span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;4.17.21&quot;</span><span class=p>,</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>  </span><span class=nt>&quot;resolved&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz&quot;</span><span class=p>,</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>  </span><span class=nt>&quot;integrity&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==&quot;</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=p>}</span>
</span></code></pre></div> <ul> <li><strong>Pin to Specific Versions</strong>: Avoid using version ranges (<code>^</code>, <code>~</code>, <code>&gt;=</code>, <code>*</code>) when security is critical. Pin to exact versions to prevent automatic updates that might introduce vulnerabilities.</li> </ul> <div class="language-json highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1>// Bad - allows potentially insecure updates</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>  </span><span class=nt>&quot;express&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;^4.17.1&quot;</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=p>}</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=c1>// Good - pins to specific version</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>  </span><span class=nt>&quot;express&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;4.17.1&quot;</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=p>}</span>
</span></code></pre></div> <ul> <li><strong>Use Checksums/Integrity Verification</strong>: Ensure your package manager verifies the integrity of downloaded packages.</li> </ul> <h3 id=3-monitoring-and-updates>3. Monitoring and Updates<a class=headerlink href=#3-monitoring-and-updates title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Regularly Update Dependencies</strong>: Keep your dependencies up to date to benefit from security patches and improvements. Use tools that can automate this process.</p> </li> <li> <p><strong>Monitor for Vulnerabilities</strong>: Set up monitoring for your dependencies to receive alerts about newly discovered vulnerabilities. Services like Snyk, GitHub Dependabot, or OWASP Dependency-Check can assist with this.</p> </li> </ul> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Example GitHub Dependabot configuration (.github/dependabot.yml)</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=nt>updates</span><span class=p>:</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>package-ecosystem</span><span class=p>:</span><span class=w> </span><span class=s>&quot;npm&quot;</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/&quot;</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=nt>schedule</span><span class=p>:</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>      </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=s>&quot;weekly&quot;</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>    </span><span class=nt>security-updates-only</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div> <ul> <li><strong>Implement Security Scanning in CI/CD</strong>: Integrate dependency scanning tools into your CI/CD pipeline to automatically check for vulnerabilities during the build process.</li> </ul> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Example GitHub Action for dependency scanning</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Security Scan</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=nt>on</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>push</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>pull_request</span><span class="p p-Indicator">]</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=nt>jobs</span><span class=p>:</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>  </span><span class=nt>security</span><span class=p>:</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Run Snyk to check for vulnerabilities</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">snyk/actions/node@master</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>        </span><span class=nt>env</span><span class=p>:</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=w>          </span><span class=nt>SNYK_TOKEN</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.SNYK_TOKEN }}</span>
</span></code></pre></div> <h3 id=4-risk-reduction-strategies>4. Risk Reduction Strategies<a class=headerlink href=#4-risk-reduction-strategies title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Minimize Dependencies</strong>: Only include dependencies that are absolutely necessary for your project. This reduces the attack surface and potential vulnerabilities.</p> </li> <li> <p><strong>Use Private Registries or Mirrors</strong>: Consider using private registries or mirrors to cache and pre-approve dependencies.</p> </li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Configure npm to use a private registry</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>npm<span class=w> </span>config<span class=w> </span><span class=nb>set</span><span class=w> </span>registry<span class=w> </span>https://private-registry.company.com/
</span></code></pre></div> <ul> <li> <p><strong>Review Dependency Licenses</strong>: Ensure that the licenses of your dependencies are compatible with your project and do not impose unexpected obligations.</p> </li> <li> <p><strong>Implement Dependency Firewall</strong>: Use tools like npm-audit-resolver to create policies for allowed dependencies.</p> </li> </ul> <h3 id=5-advanced-techniques>5. Advanced Techniques<a class=headerlink href=#5-advanced-techniques title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Vendor Dependencies</strong>: For critical applications, consider vendoring (copying dependencies directly into your repository) to prevent supply chain attacks.</p> </li> <li> <p><strong>Use Runtime Application Self-Protection (RASP)</strong>: Implement RASP tools that can detect and block attacks exploiting vulnerabilities in dependencies during runtime.</p> </li> <li> <p><strong>Air-gapped Builds</strong>: For highly sensitive systems, consider building in air-gapped environments to prevent dependency confusion attacks.</p> </li> <li> <p><strong>Multi-factor Verification</strong>: Implement systems that verify dependencies through multiple validation methods (hash checking, signature verification, etc.)</p> </li> </ul> <h2 id=language-specific-tools-and-practices>Language-Specific Tools and Practices<a class=headerlink href=#language-specific-tools-and-practices title="Permanent link">&para;</a></h2> <h3 id=nodejs-javascript>Node.js / JavaScript<a class=headerlink href=#nodejs-javascript title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Audit dependencies for vulnerabilities</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>npm<span class=w> </span>audit
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=c1># Fix automatically when possible</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>npm<span class=w> </span>audit<span class=w> </span>fix
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=c1># Generate SBOM</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>npm<span class=w> </span>install<span class=w> </span>-g<span class=w> </span>@cyclonedx/cyclonedx-npm
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>cyclonedx-npm<span class=w> </span>--output-file<span class=w> </span>sbom.xml
</span></code></pre></div> <h3 id=python>Python<a class=headerlink href=#python title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Check for security issues</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>pip<span class=w> </span>install<span class=w> </span>safety
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>safety<span class=w> </span>check
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=c1># Generate dependency tree</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>pip<span class=w> </span>install<span class=w> </span>pipdeptree
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>pipdeptree
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=c1># Lock dependencies</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>pip<span class=w> </span>install<span class=w> </span>pip-tools
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>pip-compile<span class=w> </span>requirements.in
</span></code></pre></div> <h3 id=java-maven>Java / Maven<a class=headerlink href=#java-maven title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Check for vulnerabilities</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>mvn<span class=w> </span>org.owasp:dependency-check-maven:check
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1># Generate SBOM</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>mvn<span class=w> </span>org.cyclonedx:cyclonedx-maven-plugin:makeAggregateBom
</span></code></pre></div> <h3 id=go>Go<a class=headerlink href=#go title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Audit dependencies</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>go<span class=w> </span>install<span class=w> </span>golang.org/x/vuln/cmd/govulncheck@latest
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>govulncheck<span class=w> </span>./...
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=c1># Use vendoring</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>go<span class=w> </span>mod<span class=w> </span>vendor
</span></code></pre></div> <h2 id=advanced-dependency-management-strategies>Advanced Dependency Management Strategies<a class=headerlink href=#advanced-dependency-management-strategies title="Permanent link">&para;</a></h2> <p>While basic dependency management practices form a solid foundation, advanced strategies provide deeper protection against supply chain attacks and vulnerabilities.</p> <h3 id=dependency-confusion-prevention>Dependency Confusion Prevention<a class=headerlink href=#dependency-confusion-prevention title="Permanent link">&para;</a></h3> <p>Dependency confusion attacks exploit how package managers resolve dependencies when same-named packages exist in public and private repositories. To defend against these attacks:</p> <pre class=mermaid><code>flowchart TD
    classDef attack fill:#e74c3c, stroke:#333, stroke-width:1px, color:white
    classDef defense fill:#2ecc71, stroke:#333, stroke-width:1px

    A[Dependency Confusion Prevention]

    A --&gt; B[Package Manager Configuration]:::defense
    A --&gt; C[Package Namespace Protection]:::defense
    A --&gt; D[Version Pinning]:::defense
    A --&gt; E[Private Repository Scoping]:::defense

    B --&gt; B1[Configure registry precedence]
    B --&gt; B2[Disable automatic fallback]

    C --&gt; C1[Register namespaces on public repos]
    C --&gt; C2[Use organization-specific prefixes]

    D --&gt; D1[Lock file maintenance]
    D --&gt; D2[SHA integrity checks]

    E --&gt; E1[Use scoped packages]
    E --&gt; E2[Specify registry per dependency]</code></pre> <p><strong>NPM Configuration Example:</strong></p> <div class="language-json highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1>// .npmrc</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=err>#</span><span class=w> </span><span class=err>Scope</span><span class=w> </span><span class=err>all</span><span class=w> </span><span class=err>packages</span><span class=w> </span><span class=err>u</span><span class=kc>n</span><span class=err>der</span><span class=w> </span><span class=err>@compa</span><span class=kc>n</span><span class=err>y</span><span class=w> </span><span class=kc>t</span><span class=err>o</span><span class=w> </span><span class=err>priva</span><span class=kc>te</span><span class=w> </span><span class=err>regis</span><span class=kc>tr</span><span class=err>y</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=err>@compa</span><span class=kc>n</span><span class=err>y</span><span class=p>:</span><span class=err>regis</span><span class=kc>tr</span><span class=err>y=h</span><span class=kc>tt</span><span class=err>ps</span><span class=p>:</span><span class=c1>//npm.company.internal/</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=err>#</span><span class=w> </span><span class=err>Se</span><span class=kc>t</span><span class=w> </span><span class=err>regis</span><span class=kc>tr</span><span class=err>y</span><span class=w> </span><span class=kc>t</span><span class=err>oke</span><span class=kc>n</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=c1>//npm.company.internal/:_authToken=${NPM_TOKEN}</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=err>#</span><span class=w> </span><span class=err>Disable</span><span class=w> </span><span class=kc>fall</span><span class=err>back</span><span class=w> </span><span class=kc>t</span><span class=err>o</span><span class=w> </span><span class=err>public</span><span class=w> </span><span class=err>regis</span><span class=kc>tr</span><span class=err>y</span><span class=w> </span><span class=kc>f</span><span class=err>or</span><span class=w> </span><span class=err>@compa</span><span class=kc>n</span><span class=err>y</span><span class=w> </span><span class=err>scoped</span><span class=w> </span><span class=err>packages</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=err>@compa</span><span class=kc>n</span><span class=err>y</span><span class=p>:</span><span class=err>always</span><span class=mi>-</span><span class=err>au</span><span class=kc>t</span><span class=err>h=</span><span class=kc>true</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=err>#</span><span class=w> </span><span class=err>Veri</span><span class=kc>f</span><span class=err>y</span><span class=w> </span><span class=err>regis</span><span class=kc>tr</span><span class=err>y</span><span class=w> </span><span class=err>SSL</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=err>s</span><span class=kc>tr</span><span class=err>ic</span><span class=kc>t</span><span class=mi>-</span><span class=err>ssl=</span><span class=kc>true</span>
</span></code></pre></div> <p><strong>Yarn Configuration Example:</strong></p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># .yarnrc.yml</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=nt>npmScopes</span><span class=p>:</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>  </span><span class=nt>company</span><span class=p>:</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>    </span><span class=nt>npmRegistryServer</span><span class=p>:</span><span class=w> </span><span class=s>&quot;https://npm.company.internal/&quot;</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span><span class=nt>npmAlwaysAuth</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class=nt>npmAuthToken</span><span class=p>:</span><span class=w> </span><span class=s>&quot;${NPM_TOKEN}&quot;</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=c1># Disable public registry for specific packages</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=nt>packageExtensions</span><span class=p>:</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>  </span><span class=s>&quot;internal-component@*&quot;</span><span class="p p-Indicator">:</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>    </span><span class=nt>dependencies</span><span class=p>:</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>      </span><span class=s>&quot;company-lib&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;workspace:*&quot;</span>
</span></code></pre></div> <p><strong>Maven Configuration Example:</strong></p> <div class="language-xml highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=cm>&lt;!-- settings.xml --&gt;</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=nt>&lt;settings&gt;</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>  </span><span class=nt>&lt;mirrors&gt;</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span><span class=cm>&lt;!-- Block external access for internal group IDs --&gt;</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>    </span><span class=nt>&lt;mirror&gt;</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>      </span><span class=nt>&lt;id&gt;</span>internal-repository<span class=nt>&lt;/id&gt;</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=w>      </span><span class=nt>&lt;name&gt;</span>Internal<span class=w> </span>Repository<span class=w> </span>Manager<span class=nt>&lt;/name&gt;</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=w>      </span><span class=nt>&lt;url&gt;</span>https://repo.company.internal/maven<span class=nt>&lt;/url&gt;</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=w>      </span><span class=nt>&lt;mirrorOf&gt;</span>*<span class=nt>&lt;/mirrorOf&gt;</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=w>    </span><span class=nt>&lt;/mirror&gt;</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=w>  </span><span class=nt>&lt;/mirrors&gt;</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=w>  </span><span class=cm>&lt;!-- Configure repository-specific credentials --&gt;</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=w>  </span><span class=nt>&lt;servers&gt;</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=w>    </span><span class=nt>&lt;server&gt;</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=w>      </span><span class=nt>&lt;id&gt;</span>internal-repository<span class=nt>&lt;/id&gt;</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=w>      </span><span class=nt>&lt;username&gt;</span>${env.MAVEN_USERNAME}<span class=nt>&lt;/username&gt;</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=w>      </span><span class=nt>&lt;password&gt;</span>${env.MAVEN_PASSWORD}<span class=nt>&lt;/password&gt;</span>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=w>    </span><span class=nt>&lt;/server&gt;</span>
</span><span id=__span-12-20><a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=w>  </span><span class=nt>&lt;/servers&gt;</span>
</span><span id=__span-12-21><a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a><span class=nt>&lt;/settings&gt;</span>
</span></code></pre></div> <h3 id=dependency-verification-and-attestation>Dependency Verification and Attestation<a class=headerlink href=#dependency-verification-and-attestation title="Permanent link">&para;</a></h3> <p>Move beyond basic integrity checks to comprehensive verification of dependencies:</p> <ol> <li><strong>Signature Verification</strong></li> </ol> <div class="language-bash highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># NPM signature verification with sigstore</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>npm<span class=w> </span>audit<span class=w> </span>signatures<span class=w> </span>lodash@4.17.21
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1># Verify JAR signatures</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>jarsigner<span class=w> </span>-verify<span class=w> </span>-certs<span class=w> </span>-verbose<span class=w> </span>my-dependency.jar
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=c1># Verify Python package signatures</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>gpg<span class=w> </span>--verify<span class=w> </span>downloaded_package.tar.gz.asc<span class=w> </span>downloaded_package.tar.gz
</span></code></pre></div> <ol> <li><strong>Reproducible Builds Verification</strong></li> </ol> <div class="language-bash highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Example build verification script</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=c1>#!/bin/bash</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=c1># Clone the source at the specific version</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/dependency/repo.git
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=nb>cd</span><span class=w> </span>repo
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>git<span class=w> </span>checkout<span class=w> </span>v1.2.3
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=c1># Build from source using defined build environment</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span>-v<span class=w> </span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>:/src<span class=w> </span>build-environment:1.0<span class=w> </span><span class=se>\</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=w>  </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;cd /src &amp;&amp; npm ci &amp;&amp; npm run build&quot;</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=c1># Compare built artifact with downloaded one</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>sha256sum<span class=w> </span>./dist/package.min.js<span class=w> </span>&gt;<span class=w> </span>built.sha256
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>sha256sum<span class=w> </span>../downloaded/package.min.js<span class=w> </span>&gt;<span class=w> </span>downloaded.sha256
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=k>if</span><span class=w> </span>cmp<span class=w> </span>-s<span class=w> </span>built.sha256<span class=w> </span>downloaded.sha256<span class=p>;</span><span class=w> </span><span class=k>then</span>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Verification successful: builds match&quot;</span>
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>  </span><span class=nb>exit</span><span class=w> </span><span class=m>0</span>
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=k>else</span>
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Verification failed: builds differ&quot;</span>
</span><span id=__span-14-22><a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=w>  </span><span class=nb>exit</span><span class=w> </span><span class=m>1</span>
</span><span id=__span-14-23><a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=k>fi</span>
</span></code></pre></div> <ol> <li><strong>Supply Chain Level for Software Artifacts (SLSA) Verification</strong></li> </ol> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1># Example SLSA provenance verification</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=kn>import</span> <span class=nn>json</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=kn>from</span> <span class=nn>cryptography.x509</span> <span class=kn>import</span> <span class=n>load_pem_x509_certificate</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives.asymmetric</span> <span class=kn>import</span> <span class=n>padding</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives</span> <span class=kn>import</span> <span class=n>hashes</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=k>def</span> <span class=nf>verify_slsa_attestation</span><span class=p>(</span><span class=n>attestation_path</span><span class=p>,</span> <span class=n>artifact_path</span><span class=p>):</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Verify SLSA attestation for an artifact.&quot;&quot;&quot;</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>    <span class=c1># Load attestation</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>attestation_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>        <span class=n>attestation</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>    <span class=c1># Extract certificate and signature</span>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a>    <span class=n>cert_data</span> <span class=o>=</span> <span class=n>attestation</span><span class=p>[</span><span class=s1>&#39;payload&#39;</span><span class=p>][</span><span class=s1>&#39;certificate&#39;</span><span class=p>]</span>
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>    <span class=n>signature</span> <span class=o>=</span> <span class=n>attestation</span><span class=p>[</span><span class=s1>&#39;signature&#39;</span><span class=p>]</span>
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>    <span class=c1># Load certificate</span>
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>    <span class=n>cert</span> <span class=o>=</span> <span class=n>load_pem_x509_certificate</span><span class=p>(</span><span class=n>cert_data</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a>    <span class=n>public_key</span> <span class=o>=</span> <span class=n>cert</span><span class=o>.</span><span class=n>public_key</span><span class=p>()</span>
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a>
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a>    <span class=c1># Calculate artifact digest</span>
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>artifact_path</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a>        <span class=n>artifact_data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a>    <span class=n>artifact_digest</span> <span class=o>=</span> <span class=n>hashes</span><span class=o>.</span><span class=n>Hash</span><span class=p>(</span><span class=n>hashes</span><span class=o>.</span><span class=n>SHA256</span><span class=p>())</span>
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a>    <span class=n>artifact_digest</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>artifact_data</span><span class=p>)</span>
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a>    <span class=n>digest</span> <span class=o>=</span> <span class=n>artifact_digest</span><span class=o>.</span><span class=n>finalize</span><span class=p>()</span>
</span><span id=__span-15-27><a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a>
</span><span id=__span-15-28><a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a>    <span class=c1># Verify signature</span>
</span><span id=__span-15-29><a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-15-30><a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a>        <span class=n>public_key</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span>
</span><span id=__span-15-31><a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>            <span class=n>signature</span><span class=p>,</span>
</span><span id=__span-15-32><a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a>            <span class=n>digest</span><span class=p>,</span>
</span><span id=__span-15-33><a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a>            <span class=n>padding</span><span class=o>.</span><span class=n>PKCS1v15</span><span class=p>(),</span>
</span><span id=__span-15-34><a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a>            <span class=n>hashes</span><span class=o>.</span><span class=n>SHA256</span><span class=p>()</span>
</span><span id=__span-15-35><a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a>        <span class=p>)</span>
</span><span id=__span-15-36><a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Signature verification successful&quot;</span><span class=p>)</span>
</span><span id=__span-15-37><a id=__codelineno-15-37 name=__codelineno-15-37 href=#__codelineno-15-37></a>
</span><span id=__span-15-38><a id=__codelineno-15-38 name=__codelineno-15-38 href=#__codelineno-15-38></a>        <span class=c1># Verify provenance attributes</span>
</span><span id=__span-15-39><a id=__codelineno-15-39 name=__codelineno-15-39 href=#__codelineno-15-39></a>        <span class=n>builder</span> <span class=o>=</span> <span class=n>attestation</span><span class=p>[</span><span class=s1>&#39;payload&#39;</span><span class=p>][</span><span class=s1>&#39;provenance&#39;</span><span class=p>][</span><span class=s1>&#39;builder&#39;</span><span class=p>]</span>
</span><span id=__span-15-40><a id=__codelineno-15-40 name=__codelineno-15-40 href=#__codelineno-15-40></a>        <span class=n>built_from</span> <span class=o>=</span> <span class=n>attestation</span><span class=p>[</span><span class=s1>&#39;payload&#39;</span><span class=p>][</span><span class=s1>&#39;provenance&#39;</span><span class=p>][</span><span class=s1>&#39;materials&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;uri&#39;</span><span class=p>]</span>
</span><span id=__span-15-41><a id=__codelineno-15-41 name=__codelineno-15-41 href=#__codelineno-15-41></a>
</span><span id=__span-15-42><a id=__codelineno-15-42 name=__codelineno-15-42 href=#__codelineno-15-42></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Built by: </span><span class=si>{</span><span class=n>builder</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-15-43><a id=__codelineno-15-43 name=__codelineno-15-43 href=#__codelineno-15-43></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Built from: </span><span class=si>{</span><span class=n>built_from</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-15-44><a id=__codelineno-15-44 name=__codelineno-15-44 href=#__codelineno-15-44></a>
</span><span id=__span-15-45><a id=__codelineno-15-45 name=__codelineno-15-45 href=#__codelineno-15-45></a>        <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-15-46><a id=__codelineno-15-46 name=__codelineno-15-46 href=#__codelineno-15-46></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-15-47><a id=__codelineno-15-47 name=__codelineno-15-47 href=#__codelineno-15-47></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Verification failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-15-48><a id=__codelineno-15-48 name=__codelineno-15-48 href=#__codelineno-15-48></a>        <span class=k>return</span> <span class=kc>False</span>
</span></code></pre></div> <h3 id=dependency-firewall-architecture>Dependency Firewall Architecture<a class=headerlink href=#dependency-firewall-architecture title="Permanent link">&para;</a></h3> <p>Implement a multi-layered approach to dependency security:</p> <pre class=mermaid><code>graph TB
    classDef zone1 fill:#6a89cc, stroke:#333, stroke-width:1px, color:white
    classDef zone2 fill:#82ccdd, stroke:#333, stroke-width:1px
    classDef zone3 fill:#78e08f, stroke:#333, stroke-width:1px

    subgraph "External Zone"
        A[Public Package Repositories]
    end

    subgraph "DMZ"
        B[Package Proxy/Cache]
        C[Dependency Scanner]
        D[Policy Enforcement]
    end

    subgraph "Internal Zone"
        E[Private Package Repository]
        F[Approved Packages]
        G[CI/CD Systems]
        H[Developer Workstations]
    end

    A --&gt; B
    B --&gt; C
    C --&gt; D
    D --&gt;|Approved| E
    D --&gt;|Rejected| I[Quarantine]
    E --&gt; F
    F --&gt; G
    F --&gt; H

    classDef zone1 zone1
    classDef zone2 zone2
    classDef zone3 zone3</code></pre> <p><strong>Implementation with Artifactory JFrog:</strong></p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># Example Artifactory configuration for dependency firewall</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=nt>repositories</span><span class=p>:</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=w>  </span><span class=c1># Remote repositories (proxies to external sources)</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>  </span><span class=nt>remote</span><span class=p>:</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>    </span><span class=nt>npm-remote</span><span class=p>:</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://registry.npmjs.org</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>      </span><span class=nt>xray</span><span class=p>:</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=w>      </span><span class=nt>blackedOut</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=w>      </span><span class=nt>propertySets</span><span class=p>:</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">core-properties</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=w>    </span><span class=nt>maven-remote</span><span class=p>:</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://repo.maven.apache.org/maven2</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=w>      </span><span class=nt>xray</span><span class=p>:</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>      </span><span class=nt>blackedOut</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=w>  </span><span class=c1># Virtual repositories (the entry points for developers)</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=w>  </span><span class=nt>virtual</span><span class=p>:</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=w>    </span><span class=nt>npm-virtual</span><span class=p>:</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=w>      </span><span class=nt>includes</span><span class=p>:</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">npm-approved-local</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">npm-quarantine-local</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">npm-remote</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=w>      </span><span class=nt>defaultDeploymentRepo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">npm-quarantine-local</span>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=w>    </span><span class=nt>maven-virtual</span><span class=p>:</span>
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=w>      </span><span class=nt>includes</span><span class=p>:</span>
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">maven-approved-local</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">maven-quarantine-local</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">maven-remote</span>
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=w>      </span><span class=nt>defaultDeploymentRepo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">maven-quarantine-local</span>
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a>
</span><span id=__span-16-35><a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a><span class=w>  </span><span class=c1># Local repositories</span>
</span><span id=__span-16-36><a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a><span class=w>  </span><span class=nt>local</span><span class=p>:</span>
</span><span id=__span-16-37><a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=w>    </span><span class=nt>npm-approved-local</span><span class=p>:</span>
</span><span id=__span-16-38><a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a><span class=w>      </span><span class=nt>xrayIndex</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-16-39><a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a><span class=w>      </span><span class=nt>propertySets</span><span class=p>:</span>
</span><span id=__span-16-40><a id=__codelineno-16-40 name=__codelineno-16-40 href=#__codelineno-16-40></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">core-properties</span>
</span><span id=__span-16-41><a id=__codelineno-16-41 name=__codelineno-16-41 href=#__codelineno-16-41></a>
</span><span id=__span-16-42><a id=__codelineno-16-42 name=__codelineno-16-42 href=#__codelineno-16-42></a><span class=w>    </span><span class=nt>npm-quarantine-local</span><span class=p>:</span>
</span><span id=__span-16-43><a id=__codelineno-16-43 name=__codelineno-16-43 href=#__codelineno-16-43></a><span class=w>      </span><span class=nt>xrayIndex</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-16-44><a id=__codelineno-16-44 name=__codelineno-16-44 href=#__codelineno-16-44></a><span class=w>      </span><span class=nt>propertySets</span><span class=p>:</span>
</span><span id=__span-16-45><a id=__codelineno-16-45 name=__codelineno-16-45 href=#__codelineno-16-45></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">core-properties</span>
</span><span id=__span-16-46><a id=__codelineno-16-46 name=__codelineno-16-46 href=#__codelineno-16-46></a>
</span><span id=__span-16-47><a id=__codelineno-16-47 name=__codelineno-16-47 href=#__codelineno-16-47></a><span class=c1># XRay policies</span>
</span><span id=__span-16-48><a id=__codelineno-16-48 name=__codelineno-16-48 href=#__codelineno-16-48></a><span class=nt>xray</span><span class=p>:</span>
</span><span id=__span-16-49><a id=__codelineno-16-49 name=__codelineno-16-49 href=#__codelineno-16-49></a><span class=w>  </span><span class=nt>policies</span><span class=p>:</span>
</span><span id=__span-16-50><a id=__codelineno-16-50 name=__codelineno-16-50 href=#__codelineno-16-50></a><span class=w>    </span><span class=nt>security-policy</span><span class=p>:</span>
</span><span id=__span-16-51><a id=__codelineno-16-51 name=__codelineno-16-51 href=#__codelineno-16-51></a><span class=w>      </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
</span><span id=__span-16-52><a id=__codelineno-16-52 name=__codelineno-16-52 href=#__codelineno-16-52></a><span class=w>      </span><span class=nt>rule</span><span class=p>:</span>
</span><span id=__span-16-53><a id=__codelineno-16-53 name=__codelineno-16-53 href=#__codelineno-16-53></a><span class=w>        </span><span class=nt>min-severity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">medium</span>
</span><span id=__span-16-54><a id=__codelineno-16-54 name=__codelineno-16-54 href=#__codelineno-16-54></a><span class=w>        </span><span class=nt>block-unscanned</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-16-55><a id=__codelineno-16-55 name=__codelineno-16-55 href=#__codelineno-16-55></a><span class=w>        </span><span class=nt>fail-build</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-16-56><a id=__codelineno-16-56 name=__codelineno-16-56 href=#__codelineno-16-56></a>
</span><span id=__span-16-57><a id=__codelineno-16-57 name=__codelineno-16-57 href=#__codelineno-16-57></a><span class=w>    </span><span class=nt>license-policy</span><span class=p>:</span>
</span><span id=__span-16-58><a id=__codelineno-16-58 name=__codelineno-16-58 href=#__codelineno-16-58></a><span class=w>      </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">license</span>
</span><span id=__span-16-59><a id=__codelineno-16-59 name=__codelineno-16-59 href=#__codelineno-16-59></a><span class=w>      </span><span class=nt>rule</span><span class=p>:</span>
</span><span id=__span-16-60><a id=__codelineno-16-60 name=__codelineno-16-60 href=#__codelineno-16-60></a><span class=w>        </span><span class=nt>allow</span><span class=p>:</span>
</span><span id=__span-16-61><a id=__codelineno-16-61 name=__codelineno-16-61 href=#__codelineno-16-61></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MIT</span>
</span><span id=__span-16-62><a id=__codelineno-16-62 name=__codelineno-16-62 href=#__codelineno-16-62></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Apache-2.0</span>
</span><span id=__span-16-63><a id=__codelineno-16-63 name=__codelineno-16-63 href=#__codelineno-16-63></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">BSD-3-Clause</span>
</span><span id=__span-16-64><a id=__codelineno-16-64 name=__codelineno-16-64 href=#__codelineno-16-64></a><span class=w>        </span><span class=nt>block</span><span class=p>:</span>
</span><span id=__span-16-65><a id=__codelineno-16-65 name=__codelineno-16-65 href=#__codelineno-16-65></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">GPL-3.0</span>
</span><span id=__span-16-66><a id=__codelineno-16-66 name=__codelineno-16-66 href=#__codelineno-16-66></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AGPL-3.0</span>
</span></code></pre></div> <p><strong>Nexus Repository Manager Configuration:</strong></p> <div class="language-json highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1>// Example Nexus security policy</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=p>{</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=w>  </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;dependency-firewall&quot;</span><span class=p>,</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>  </span><span class=nt>&quot;format&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;npm&quot;</span><span class=p>,</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>  </span><span class=nt>&quot;mode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;block&quot;</span><span class=p>,</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>  </span><span class=nt>&quot;criterias&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>      </span><span class=nt>&quot;operator&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;equals&quot;</span><span class=p>,</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>      </span><span class=nt>&quot;attribute&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;vulnerability.severity&quot;</span><span class=p>,</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>      </span><span class=nt>&quot;value&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;critical&quot;</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>    </span><span class=p>},</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=w>      </span><span class=nt>&quot;operator&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;regex&quot;</span><span class=p>,</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=w>      </span><span class=nt>&quot;attribute&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;name&quot;</span><span class=p>,</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=w>      </span><span class=nt>&quot;value&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;^suspicious.*&quot;</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=w>    </span><span class=p>},</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=w>      </span><span class=nt>&quot;operator&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;matches&quot;</span><span class=p>,</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=w>      </span><span class=nt>&quot;attribute&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;license&quot;</span><span class=p>,</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=w>      </span><span class=nt>&quot;value&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;GPL-*&quot;</span><span class=p>]</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=w>  </span><span class=p>]</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=p>}</span>
</span></code></pre></div> <h3 id=dependency-risk-scoring-and-prioritization>Dependency Risk Scoring and Prioritization<a class=headerlink href=#dependency-risk-scoring-and-prioritization title="Permanent link">&para;</a></h3> <p>Develop a comprehensive scoring system for dependency risk:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># Example dependency risk scoring algorithm</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=k>def</span> <span class=nf>calculate_dependency_risk</span><span class=p>(</span><span class=n>dependency</span><span class=p>):</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Calculate risk score for a dependency.&quot;&quot;&quot;</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=n>score</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=c1># Security factors</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;has_vulnerabilities&#39;</span><span class=p>]:</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>        <span class=n>vuln_score</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=s1>&#39;cvss_score&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;vulnerabilities&#39;</span><span class=p>])</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>        <span class=n>score</span> <span class=o>+=</span> <span class=nb>min</span><span class=p>(</span><span class=n>vuln_score</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span>  <span class=c1># Max 20 points</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>    <span class=c1># Maintenance factors</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;last_release&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>365</span><span class=p>:</span>  <span class=c1># days</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>5</span>  <span class=c1># Unmaintained</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>    <span class=k>elif</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;last_release&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>180</span><span class=p>:</span>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>3</span>  <span class=c1># Poorly maintained</span>
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;open_issues&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>100</span> <span class=ow>and</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;open_issues_rate&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mf>0.7</span><span class=p>:</span>
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>5</span>  <span class=c1># Many unresolved issues</span>
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a>    <span class=c1># Popularity factors</span>
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;downloads_last_month&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>1000</span><span class=p>:</span>
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>5</span>  <span class=c1># Low adoption</span>
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a>    <span class=k>elif</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;downloads_last_month&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=p>:</span>
</span><span id=__span-18-24><a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>3</span>  <span class=c1># Moderate adoption</span>
</span><span id=__span-18-25><a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a>
</span><span id=__span-18-26><a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a>    <span class=c1># Supply chain factors</span>
</span><span id=__span-18-27><a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;has_2fa&#39;</span><span class=p>]:</span>
</span><span id=__span-18-28><a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>5</span>  <span class=c1># No 2FA for maintainers</span>
</span><span id=__span-18-29><a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a>
</span><span id=__span-18-30><a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;contributors_count&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>:</span>
</span><span id=__span-18-31><a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>3</span>  <span class=c1># Too few maintainers</span>
</span><span id=__span-18-32><a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a>
</span><span id=__span-18-33><a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a>    <span class=c1># License factors</span>
</span><span id=__span-18-34><a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;license&#39;</span><span class=p>]</span> <span class=ow>in</span> <span class=n>HIGH_RISK_LICENSES</span><span class=p>:</span>
</span><span id=__span-18-35><a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>5</span>
</span><span id=__span-18-36><a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a>    <span class=k>elif</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;license&#39;</span><span class=p>]</span> <span class=ow>in</span> <span class=n>MEDIUM_RISK_LICENSES</span><span class=p>:</span>
</span><span id=__span-18-37><a id=__codelineno-18-37 name=__codelineno-18-37 href=#__codelineno-18-37></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mi>3</span>
</span><span id=__span-18-38><a id=__codelineno-18-38 name=__codelineno-18-38 href=#__codelineno-18-38></a>
</span><span id=__span-18-39><a id=__codelineno-18-39 name=__codelineno-18-39 href=#__codelineno-18-39></a>    <span class=c1># Usage factors</span>
</span><span id=__span-18-40><a id=__codelineno-18-40 name=__codelineno-18-40 href=#__codelineno-18-40></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;is_direct&#39;</span><span class=p>]:</span>
</span><span id=__span-18-41><a id=__codelineno-18-41 name=__codelineno-18-41 href=#__codelineno-18-41></a>        <span class=n>score</span> <span class=o>*=</span> <span class=mf>1.2</span>  <span class=c1># Direct dependencies are higher risk</span>
</span><span id=__span-18-42><a id=__codelineno-18-42 name=__codelineno-18-42 href=#__codelineno-18-42></a>
</span><span id=__span-18-43><a id=__codelineno-18-43 name=__codelineno-18-43 href=#__codelineno-18-43></a>    <span class=k>if</span> <span class=n>dependency</span><span class=p>[</span><span class=s1>&#39;used_in_critical_path&#39;</span><span class=p>]:</span>
</span><span id=__span-18-44><a id=__codelineno-18-44 name=__codelineno-18-44 href=#__codelineno-18-44></a>        <span class=n>score</span> <span class=o>*=</span> <span class=mf>1.5</span>  <span class=c1># Used in critical application features</span>
</span><span id=__span-18-45><a id=__codelineno-18-45 name=__codelineno-18-45 href=#__codelineno-18-45></a>
</span><span id=__span-18-46><a id=__codelineno-18-46 name=__codelineno-18-46 href=#__codelineno-18-46></a>    <span class=k>return</span> <span class=nb>min</span><span class=p>(</span><span class=n>score</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>  <span class=c1># Cap at 100</span>
</span></code></pre></div> <p>Integrate this scoring into your CI/CD pipeline for dependency assessment and remediation prioritization:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># Example GitHub Action for dependency risk assessment</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Dependency Risk Assessment</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=nt>on</span><span class=p>:</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>  </span><span class=nt>push</span><span class=p>:</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=w> </span><span class=nv>main</span><span class=w> </span><span class="p p-Indicator">]</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>  </span><span class=nt>pull_request</span><span class=p>:</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=w> </span><span class=nv>main</span><span class=w> </span><span class="p p-Indicator">]</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>  </span><span class=nt>schedule</span><span class=p>:</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>cron</span><span class=p>:</span><span class=w> </span><span class=s>&#39;0</span><span class=nv> </span><span class=s>0</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>1&#39;</span><span class=w>  </span><span class=c1># Weekly on Mondays</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=nt>jobs</span><span class=p>:</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>  </span><span class=nt>assess-dependencies</span><span class=p>:</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a>
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">npm ci</span>
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a>
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Generate dependency data</span>
</span><span id=__span-19-23><a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-19-24><a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=w>          </span><span class=no>npx dependency-risk-analyzer &gt; dependency-data.json</span>
</span><span id=__span-19-25><a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a>
</span><span id=__span-19-26><a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Calculate risk scores</span>
</span><span id=__span-19-27><a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-19-28><a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a><span class=w>          </span><span class=no>python .github/scripts/calculate_risk.py \</span>
</span><span id=__span-19-29><a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a><span class=w>            </span><span class=no>--input dependency-data.json \</span>
</span><span id=__span-19-30><a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a><span class=w>            </span><span class=no>--output risk-report.json</span>
</span><span id=__span-19-31><a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a>
</span><span id=__span-19-32><a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Generate risk report</span>
</span><span id=__span-19-33><a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-19-34><a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a><span class=w>          </span><span class=no>python .github/scripts/generate_report.py \</span>
</span><span id=__span-19-35><a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a><span class=w>            </span><span class=no>--input risk-report.json \</span>
</span><span id=__span-19-36><a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a><span class=w>            </span><span class=no>--output risk-report.md</span>
</span><span id=__span-19-37><a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a>
</span><span id=__span-19-38><a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Upload risk report</span>
</span><span id=__span-19-39><a id=__codelineno-19-39 name=__codelineno-19-39 href=#__codelineno-19-39></a><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v3</span>
</span><span id=__span-19-40><a id=__codelineno-19-40 name=__codelineno-19-40 href=#__codelineno-19-40></a><span class=w>        </span><span class=nt>with</span><span class=p>:</span>
</span><span id=__span-19-41><a id=__codelineno-19-41 name=__codelineno-19-41 href=#__codelineno-19-41></a><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dependency-risk-report</span>
</span><span id=__span-19-42><a id=__codelineno-19-42 name=__codelineno-19-42 href=#__codelineno-19-42></a><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">risk-report.md</span>
</span><span id=__span-19-43><a id=__codelineno-19-43 name=__codelineno-19-43 href=#__codelineno-19-43></a>
</span><span id=__span-19-44><a id=__codelineno-19-44 name=__codelineno-19-44 href=#__codelineno-19-44></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Fail if high-risk dependencies found</span>
</span><span id=__span-19-45><a id=__codelineno-19-45 name=__codelineno-19-45 href=#__codelineno-19-45></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-19-46><a id=__codelineno-19-46 name=__codelineno-19-46 href=#__codelineno-19-46></a><span class=w>          </span><span class=no>HIGH_RISK=$(jq &#39;.dependencies | map(select(.risk_score &gt; 70)) | length&#39; risk-report.json)</span>
</span><span id=__span-19-47><a id=__codelineno-19-47 name=__codelineno-19-47 href=#__codelineno-19-47></a><span class=w>          </span><span class=no>if [ &quot;$HIGH_RISK&quot; -gt 0 ]; then</span>
</span><span id=__span-19-48><a id=__codelineno-19-48 name=__codelineno-19-48 href=#__codelineno-19-48></a><span class=w>            </span><span class=no>echo &quot; $HIGH_RISK high-risk dependencies found&quot;</span>
</span><span id=__span-19-49><a id=__codelineno-19-49 name=__codelineno-19-49 href=#__codelineno-19-49></a><span class=w>            </span><span class=no>jq &#39;.dependencies | map(select(.risk_score &gt; 70)) | .[]&#39; risk-report.json</span>
</span><span id=__span-19-50><a id=__codelineno-19-50 name=__codelineno-19-50 href=#__codelineno-19-50></a><span class=w>            </span><span class=no>exit 1</span>
</span><span id=__span-19-51><a id=__codelineno-19-51 name=__codelineno-19-51 href=#__codelineno-19-51></a><span class=w>          </span><span class=no>else</span>
</span><span id=__span-19-52><a id=__codelineno-19-52 name=__codelineno-19-52 href=#__codelineno-19-52></a><span class=w>            </span><span class=no>echo &quot; No high-risk dependencies found&quot;</span>
</span><span id=__span-19-53><a id=__codelineno-19-53 name=__codelineno-19-53 href=#__codelineno-19-53></a><span class=w>          </span><span class=no>fi</span>
</span></code></pre></div> <h2 id=dependency-management-implementation-guide>Dependency Management Implementation Guide<a class=headerlink href=#dependency-management-implementation-guide title="Permanent link">&para;</a></h2> <h3 id=step-1-dependency-inventory-and-classification>Step 1: Dependency Inventory and Classification<a class=headerlink href=#step-1-dependency-inventory-and-classification title="Permanent link">&para;</a></h3> <p>Begin by creating a comprehensive inventory of all dependencies across your projects:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1># Generate dependency reports for all repositories</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=k>for</span><span class=w> </span>repo<span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>$(</span>ls<span class=w> </span>-d<span class=w> </span>*/<span class=k>)</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>  </span><span class=nb>cd</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$repo</span><span class=s2>&quot;</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Processing </span><span class=nv>$repo</span><span class=s2>&quot;</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=w>  </span><span class=c1># For npm projects</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span>package.json<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=w>    </span>npm<span class=w> </span>list<span class=w> </span>--json<span class=w> </span>&gt;<span class=w> </span>dependency-report.json
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=w>  </span><span class=k>fi</span>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=w>  </span><span class=c1># For Python projects</span>
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span>requirements.txt<span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span>pyproject.toml<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=w>    </span>pip<span class=w> </span>install<span class=w> </span>pipdeptree
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=w>    </span>pipdeptree<span class=w> </span>--json<span class=w> </span>&gt;<span class=w> </span>dependency-report.json
</span><span id=__span-20-15><a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=w>  </span><span class=k>fi</span>
</span><span id=__span-20-16><a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a>
</span><span id=__span-20-17><a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a><span class=w>  </span><span class=c1># For Java projects</span>
</span><span id=__span-20-18><a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span>pom.xml<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
</span><span id=__span-20-19><a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=w>    </span>mvn<span class=w> </span>dependency:tree<span class=w> </span>-DoutputFile<span class=o>=</span>dependency-report.txt
</span><span id=__span-20-20><a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=w>  </span><span class=k>fi</span>
</span><span id=__span-20-21><a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a>
</span><span id=__span-20-22><a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=w>  </span><span class=nb>cd</span><span class=w> </span>..
</span><span id=__span-20-23><a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a><span class=k>done</span>
</span></code></pre></div> <p>Then classify dependencies by criticality:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Example dependency classification script</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=kn>import</span> <span class=nn>json</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=kn>import</span> <span class=nn>os</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=kn>import</span> <span class=nn>csv</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=k>def</span> <span class=nf>classify_dependency</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>metadata</span><span class=p>):</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Classify a dependency by criticality.&quot;&quot;&quot;</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>    <span class=c1># Critical dependencies directly affect security</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>    <span class=n>security_related</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>        <span class=s1>&#39;crypto&#39;</span><span class=p>,</span> <span class=s1>&#39;auth&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>,</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span> <span class=s1>&#39;cipher&#39;</span><span class=p>,</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>        <span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=s1>&#39;oauth&#39;</span><span class=p>,</span> <span class=s1>&#39;permission&#39;</span><span class=p>,</span> <span class=s1>&#39;access&#39;</span><span class=p>,</span> <span class=s1>&#39;jwt&#39;</span>
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>    <span class=p>]</span>
</span><span id=__span-21-13><a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>
</span><span id=__span-21-14><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a>    <span class=c1># Check if name or description contains security-related terms</span>
</span><span id=__span-21-15><a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>    <span class=n>is_security</span> <span class=o>=</span> <span class=nb>any</span><span class=p>(</span><span class=n>term</span> <span class=ow>in</span> <span class=n>name</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>for</span> <span class=n>term</span> <span class=ow>in</span> <span class=n>security_related</span><span class=p>)</span>
</span><span id=__span-21-16><a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>    <span class=k>if</span> <span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;description&#39;</span><span class=p>):</span>
</span><span id=__span-21-17><a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a>        <span class=n>is_security</span> <span class=o>=</span> <span class=n>is_security</span> <span class=ow>or</span> <span class=nb>any</span><span class=p>(</span><span class=n>term</span> <span class=ow>in</span> <span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;description&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> 
</span><span id=__span-21-18><a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a>                                        <span class=k>for</span> <span class=n>term</span> <span class=ow>in</span> <span class=n>security_related</span><span class=p>)</span>
</span><span id=__span-21-19><a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a>
</span><span id=__span-21-20><a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a>    <span class=k>if</span> <span class=n>is_security</span><span class=p>:</span>
</span><span id=__span-21-21><a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a>        <span class=k>return</span> <span class=s1>&#39;critical&#39;</span>
</span><span id=__span-21-22><a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a>
</span><span id=__span-21-23><a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a>    <span class=c1># High-impact dependencies affect core functionality</span>
</span><span id=__span-21-24><a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a>    <span class=k>if</span> <span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;is_direct&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;used_in_core_features&#39;</span><span class=p>):</span>
</span><span id=__span-21-25><a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a>        <span class=k>return</span> <span class=s1>&#39;high&#39;</span>
</span><span id=__span-21-26><a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a>
</span><span id=__span-21-27><a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a>    <span class=c1># Medium-impact dependencies have moderate usage</span>
</span><span id=__span-21-28><a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a>    <span class=k>if</span> <span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;is_direct&#39;</span><span class=p>):</span>
</span><span id=__span-21-29><a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a>        <span class=k>return</span> <span class=s1>&#39;medium&#39;</span>
</span><span id=__span-21-30><a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a>
</span><span id=__span-21-31><a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a>    <span class=c1># Low-impact dependencies are transitive with limited impact</span>
</span><span id=__span-21-32><a id=__codelineno-21-32 name=__codelineno-21-32 href=#__codelineno-21-32></a>    <span class=k>return</span> <span class=s1>&#39;low&#39;</span>
</span><span id=__span-21-33><a id=__codelineno-21-33 name=__codelineno-21-33 href=#__codelineno-21-33></a>
</span><span id=__span-21-34><a id=__codelineno-21-34 name=__codelineno-21-34 href=#__codelineno-21-34></a><span class=c1># Process dependency reports</span>
</span><span id=__span-21-35><a id=__codelineno-21-35 name=__codelineno-21-35 href=#__codelineno-21-35></a><span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-21-36><a id=__codelineno-21-36 name=__codelineno-21-36 href=#__codelineno-21-36></a><span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>dirs</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>):</span>
</span><span id=__span-21-37><a id=__codelineno-21-37 name=__codelineno-21-37 href=#__codelineno-21-37></a>    <span class=k>if</span> <span class=s1>&#39;dependency-report.json&#39;</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span><span id=__span-21-38><a id=__codelineno-21-38 name=__codelineno-21-38 href=#__codelineno-21-38></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=s1>&#39;dependency-report.json&#39;</span><span class=p>),</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-21-39><a id=__codelineno-21-39 name=__codelineno-21-39 href=#__codelineno-21-39></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-21-40><a id=__codelineno-21-40 name=__codelineno-21-40 href=#__codelineno-21-40></a>                <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-21-41><a id=__codelineno-21-41 name=__codelineno-21-41 href=#__codelineno-21-41></a>                <span class=n>project_name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span><span id=__span-21-42><a id=__codelineno-21-42 name=__codelineno-21-42 href=#__codelineno-21-42></a>
</span><span id=__span-21-43><a id=__codelineno-21-43 name=__codelineno-21-43 href=#__codelineno-21-43></a>                <span class=c1># Process dependencies</span>
</span><span id=__span-21-44><a id=__codelineno-21-44 name=__codelineno-21-44 href=#__codelineno-21-44></a>                <span class=k>for</span> <span class=n>dep_name</span><span class=p>,</span> <span class=n>dep_data</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;dependencies&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-21-45><a id=__codelineno-21-45 name=__codelineno-21-45 href=#__codelineno-21-45></a>                    <span class=n>classification</span> <span class=o>=</span> <span class=n>classify_dependency</span><span class=p>(</span><span class=n>dep_name</span><span class=p>,</span> <span class=n>dep_data</span><span class=p>)</span>
</span><span id=__span-21-46><a id=__codelineno-21-46 name=__codelineno-21-46 href=#__codelineno-21-46></a>
</span><span id=__span-21-47><a id=__codelineno-21-47 name=__codelineno-21-47 href=#__codelineno-21-47></a>                    <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-21-48><a id=__codelineno-21-48 name=__codelineno-21-48 href=#__codelineno-21-48></a>                        <span class=s1>&#39;project&#39;</span><span class=p>:</span> <span class=n>project_name</span><span class=p>,</span>
</span><span id=__span-21-49><a id=__codelineno-21-49 name=__codelineno-21-49 href=#__codelineno-21-49></a>                        <span class=s1>&#39;dependency&#39;</span><span class=p>:</span> <span class=n>dep_name</span><span class=p>,</span>
</span><span id=__span-21-50><a id=__codelineno-21-50 name=__codelineno-21-50 href=#__codelineno-21-50></a>                        <span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=n>dep_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;version&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>),</span>
</span><span id=__span-21-51><a id=__codelineno-21-51 name=__codelineno-21-51 href=#__codelineno-21-51></a>                        <span class=s1>&#39;classification&#39;</span><span class=p>:</span> <span class=n>classification</span><span class=p>,</span>
</span><span id=__span-21-52><a id=__codelineno-21-52 name=__codelineno-21-52 href=#__codelineno-21-52></a>                        <span class=s1>&#39;direct&#39;</span><span class=p>:</span> <span class=n>dep_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;is_direct&#39;</span><span class=p>,</span> <span class=kc>False</span><span class=p>),</span>
</span><span id=__span-21-53><a id=__codelineno-21-53 name=__codelineno-21-53 href=#__codelineno-21-53></a>                        <span class=s1>&#39;license&#39;</span><span class=p>:</span> <span class=n>dep_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;license&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>)</span>
</span><span id=__span-21-54><a id=__codelineno-21-54 name=__codelineno-21-54 href=#__codelineno-21-54></a>                    <span class=p>})</span>
</span><span id=__span-21-55><a id=__codelineno-21-55 name=__codelineno-21-55 href=#__codelineno-21-55></a>            <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span><span id=__span-21-56><a id=__codelineno-21-56 name=__codelineno-21-56 href=#__codelineno-21-56></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error processing </span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;dependency-report.json&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-21-57><a id=__codelineno-21-57 name=__codelineno-21-57 href=#__codelineno-21-57></a>
</span><span id=__span-21-58><a id=__codelineno-21-58 name=__codelineno-21-58 href=#__codelineno-21-58></a><span class=c1># Write results to CSV</span>
</span><span id=__span-21-59><a id=__codelineno-21-59 name=__codelineno-21-59 href=#__codelineno-21-59></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;dependency-inventory.csv&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-21-60><a id=__codelineno-21-60 name=__codelineno-21-60 href=#__codelineno-21-60></a>    <span class=n>writer</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>DictWriter</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>fieldnames</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-21-61><a id=__codelineno-21-61 name=__codelineno-21-61 href=#__codelineno-21-61></a>        <span class=s1>&#39;project&#39;</span><span class=p>,</span> <span class=s1>&#39;dependency&#39;</span><span class=p>,</span> <span class=s1>&#39;version&#39;</span><span class=p>,</span> <span class=s1>&#39;classification&#39;</span><span class=p>,</span> 
</span><span id=__span-21-62><a id=__codelineno-21-62 name=__codelineno-21-62 href=#__codelineno-21-62></a>        <span class=s1>&#39;direct&#39;</span><span class=p>,</span> <span class=s1>&#39;license&#39;</span>
</span><span id=__span-21-63><a id=__codelineno-21-63 name=__codelineno-21-63 href=#__codelineno-21-63></a>    <span class=p>])</span>
</span><span id=__span-21-64><a id=__codelineno-21-64 name=__codelineno-21-64 href=#__codelineno-21-64></a>    <span class=n>writer</span><span class=o>.</span><span class=n>writeheader</span><span class=p>()</span>
</span><span id=__span-21-65><a id=__codelineno-21-65 name=__codelineno-21-65 href=#__codelineno-21-65></a>    <span class=n>writer</span><span class=o>.</span><span class=n>writerows</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>
</span></code></pre></div> <h3 id=step-2-dependency-security-baseline>Step 2: Dependency Security Baseline<a class=headerlink href=#step-2-dependency-security-baseline title="Permanent link">&para;</a></h3> <p>Establish a baseline for dependency security across your projects:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># Baseline security scanning</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>npm<span class=w> </span>audit<span class=w> </span>--json<span class=w> </span>&gt;<span class=w> </span>security-baseline-npm.json
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>pip-audit<span class=w> </span>--output<span class=w> </span>json<span class=w> </span>&gt;<span class=w> </span>security-baseline-python.json
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>mvn<span class=w> </span>dependency-check:aggregate<span class=w> </span>-DoutputFormat<span class=o>=</span>JSON<span class=w> </span>-DoutputDirectory<span class=o>=</span>./baseline
</span></code></pre></div> <p>Analyze results to identify common patterns and issues:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=c1># Example security baseline analysis</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=kn>import</span> <span class=nn>json</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=c1># Load security scan results</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;security-baseline-npm.json&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>    <span class=n>npm_results</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=c1># Count vulnerabilities by severity</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=n>severity_counts</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>    <span class=s1>&#39;critical&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>    <span class=s1>&#39;high&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>    <span class=s1>&#39;moderate&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>    <span class=s1>&#39;low&#39;</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=p>}</span>
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a><span class=n>affected_deps</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span><span id=__span-23-17><a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a>
</span><span id=__span-23-18><a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a><span class=c1># Process npm results</span>
</span><span id=__span-23-19><a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a><span class=k>for</span> <span class=n>vuln</span> <span class=ow>in</span> <span class=n>npm_results</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;vulnerabilities&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
</span><span id=__span-23-20><a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a>    <span class=n>severity</span> <span class=o>=</span> <span class=n>vuln</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;severity&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>)</span>
</span><span id=__span-23-21><a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a>    <span class=k>if</span> <span class=n>severity</span> <span class=ow>in</span> <span class=n>severity_counts</span><span class=p>:</span>
</span><span id=__span-23-22><a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a>        <span class=n>severity_counts</span><span class=p>[</span><span class=n>severity</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-23-23><a id=__codelineno-23-23 name=__codelineno-23-23 href=#__codelineno-23-23></a>
</span><span id=__span-23-24><a id=__codelineno-23-24 name=__codelineno-23-24 href=#__codelineno-23-24></a>    <span class=n>affected_deps</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>vuln</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>))</span>
</span><span id=__span-23-25><a id=__codelineno-23-25 name=__codelineno-23-25 href=#__codelineno-23-25></a>
</span><span id=__span-23-26><a id=__codelineno-23-26 name=__codelineno-23-26 href=#__codelineno-23-26></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total affected dependencies: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>affected_deps</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-23-27><a id=__codelineno-23-27 name=__codelineno-23-27 href=#__codelineno-23-27></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Vulnerabilities by severity:&quot;</span><span class=p>)</span>
</span><span id=__span-23-28><a id=__codelineno-23-28 name=__codelineno-23-28 href=#__codelineno-23-28></a><span class=k>for</span> <span class=n>severity</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>severity_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-23-29><a id=__codelineno-23-29 name=__codelineno-23-29 href=#__codelineno-23-29></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>severity</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-23-30><a id=__codelineno-23-30 name=__codelineno-23-30 href=#__codelineno-23-30></a>
</span><span id=__span-23-31><a id=__codelineno-23-31 name=__codelineno-23-31 href=#__codelineno-23-31></a><span class=c1># Identify top vulnerable dependencies</span>
</span><span id=__span-23-32><a id=__codelineno-23-32 name=__codelineno-23-32 href=#__codelineno-23-32></a><span class=n>dep_count</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-23-33><a id=__codelineno-23-33 name=__codelineno-23-33 href=#__codelineno-23-33></a><span class=k>for</span> <span class=n>vuln</span> <span class=ow>in</span> <span class=n>npm_results</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;vulnerabilities&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
</span><span id=__span-23-34><a id=__codelineno-23-34 name=__codelineno-23-34 href=#__codelineno-23-34></a>    <span class=n>name</span> <span class=o>=</span> <span class=n>vuln</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span>
</span><span id=__span-23-35><a id=__codelineno-23-35 name=__codelineno-23-35 href=#__codelineno-23-35></a>    <span class=n>dep_count</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>dep_count</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-23-36><a id=__codelineno-23-36 name=__codelineno-23-36 href=#__codelineno-23-36></a>
</span><span id=__span-23-37><a id=__codelineno-23-37 name=__codelineno-23-37 href=#__codelineno-23-37></a><span class=n>top_deps</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>dep_count</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)[:</span><span class=mi>10</span><span class=p>]</span>
</span><span id=__span-23-38><a id=__codelineno-23-38 name=__codelineno-23-38 href=#__codelineno-23-38></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 10 vulnerable dependencies:&quot;</span><span class=p>)</span>
</span><span id=__span-23-39><a id=__codelineno-23-39 name=__codelineno-23-39 href=#__codelineno-23-39></a><span class=k>for</span> <span class=n>dep</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>top_deps</span><span class=p>:</span>
</span><span id=__span-23-40><a id=__codelineno-23-40 name=__codelineno-23-40 href=#__codelineno-23-40></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>dep</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2> vulnerabilities&quot;</span><span class=p>)</span>
</span></code></pre></div> <h3 id=step-3-dependency-policy-development>Step 3: Dependency Policy Development<a class=headerlink href=#step-3-dependency-policy-development title="Permanent link">&para;</a></h3> <p>Create a comprehensive dependency management policy:</p> <div class="language-markdown highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=gh># Dependency Management Policy</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=gu>## Approved Sources</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=k>-</span><span class=w> </span>NPM: registry.npmjs.org
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=k>-</span><span class=w> </span>PyPI: pypi.org
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=k>-</span><span class=w> </span>Maven Central: repo.maven.apache.org
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=gu>## Dependency Approval Process</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=k>1.</span> Developer submits dependency request via [form]
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=k>2.</span> Security team reviews request within 3 business days
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=k>3.</span> Upon approval, dependency is added to approved list
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=k>4.</span> CI/CD pipeline enforces approved dependencies
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=gu>## Version Control Requirements</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=k>-</span><span class=w> </span>All projects must use lock files (package-lock.json, poetry.lock, etc.)
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=k>-</span><span class=w> </span>Direct dependencies must specify exact versions
</span><span id=__span-24-17><a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a><span class=k>-</span><span class=w> </span>Version ranges only permitted for dev dependencies
</span><span id=__span-24-18><a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a>
</span><span id=__span-24-19><a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a><span class=gu>## Security Requirements</span>
</span><span id=__span-24-20><a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a><span class=k>-</span><span class=w> </span>No dependencies with known HIGH or CRITICAL vulnerabilities
</span><span id=__span-24-21><a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a><span class=k>-</span><span class=w> </span>All dependencies must have active maintenance (commit in last 6 months)
</span><span id=__span-24-22><a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a><span class=k>-</span><span class=w> </span>License must be on approved list (MIT, Apache 2.0, BSD, etc.)
</span><span id=__span-24-23><a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a>
</span><span id=__span-24-24><a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a><span class=gu>## Monitoring and Updates</span>
</span><span id=__span-24-25><a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a><span class=k>-</span><span class=w> </span>Weekly automated dependency scanning
</span><span id=__span-24-26><a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a><span class=k>-</span><span class=w> </span>Monthly dependency update review
</span><span id=__span-24-27><a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a><span class=k>-</span><span class=w> </span>Quarterly dependency cleanup and consolidation
</span><span id=__span-24-28><a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a>
</span><span id=__span-24-29><a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a><span class=gu>## Emergency Process</span>
</span><span id=__span-24-30><a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a>For urgent dependency changes:
</span><span id=__span-24-31><a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a><span class=k>1.</span> Submit emergency request via [emergency form]
</span><span id=__span-24-32><a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a><span class=k>2.</span> Receive expedited review (4 hour SLA)
</span><span id=__span-24-33><a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a><span class=k>3.</span> Document exception and review at next security meeting
</span></code></pre></div> <p>Implement the policy with enforcement tools:</p> <div class="language-javascript highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=c1>// Example dependency policy enforcement script (NodeJS)</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=kd>const</span><span class=w> </span><span class=nx>fs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=kd>const</span><span class=w> </span><span class=nx>path</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;path&#39;</span><span class=p>);</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=c1>// Load approved dependencies</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=kd>const</span><span class=w> </span><span class=nx>approvedDeps</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./approved-dependencies.json&#39;</span><span class=p>);</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=c1>// Load package.json</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=kd>const</span><span class=w> </span><span class=nx>packageJson</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;package.json&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;utf8&#39;</span><span class=p>));</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=c1>// Check dependencies</span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=kd>const</span><span class=w> </span><span class=nx>violations</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>depName</span><span class=p>,</span><span class=w> </span><span class=nx>depVersion</span><span class=p>]</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=nb>Object</span><span class=p>.</span><span class=nx>entries</span><span class=p>(</span><span class=nx>packageJson</span><span class=p>.</span><span class=nx>dependencies</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=p>{}))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=w>  </span><span class=c1>// Check if dependency is approved</span>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>approvedDeps</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>depName</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=w>    </span><span class=nx>violations</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
</span><span id=__span-25-18><a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a><span class=w>      </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=nx>depName</span><span class=p>,</span>
</span><span id=__span-25-19><a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=w>      </span><span class=nx>reason</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Dependency not on approved list&#39;</span><span class=p>,</span>
</span><span id=__span-25-20><a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a><span class=w>      </span><span class=nx>suggestion</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Submit for approval or use an approved alternative&#39;</span>
</span><span id=__span-25-21><a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=w>    </span><span class=p>});</span>
</span><span id=__span-25-22><a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a><span class=w>    </span><span class=k>continue</span><span class=p>;</span>
</span><span id=__span-25-23><a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-25-24><a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a>
</span><span id=__span-25-25><a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a><span class=w>  </span><span class=c1>// Check version format (must be exact)</span>
</span><span id=__span-25-26><a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>depVersion</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s1>&#39;^&#39;</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=nx>depVersion</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s1>&#39;~&#39;</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-25-27><a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a><span class=w>    </span><span class=nx>violations</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
</span><span id=__span-25-28><a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a><span class=w>      </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=nx>depName</span><span class=p>,</span>
</span><span id=__span-25-29><a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a><span class=w>      </span><span class=nx>reason</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Version must be exact (no ^ or ~)&#39;</span><span class=p>,</span>
</span><span id=__span-25-30><a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a><span class=w>      </span><span class=nx>suggestion</span><span class=o>:</span><span class=w> </span><span class=sb>`Change &quot;</span><span class=si>${</span><span class=nx>depName</span><span class=si>}</span><span class=sb>&quot;: &quot;</span><span class=si>${</span><span class=nx>depVersion</span><span class=si>}</span><span class=sb>&quot; to &quot;</span><span class=si>${</span><span class=nx>depName</span><span class=si>}</span><span class=sb>&quot;: &quot;</span><span class=si>${</span><span class=nx>depVersion</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/[\^~]/</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=si>}</span><span class=sb>&quot;`</span>
</span><span id=__span-25-31><a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a><span class=w>    </span><span class=p>});</span>
</span><span id=__span-25-32><a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-25-33><a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a><span class=p>}</span>
</span><span id=__span-25-34><a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a>
</span><span id=__span-25-35><a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a><span class=c1>// Output results</span>
</span><span id=__span-25-36><a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>violations</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-25-37><a id=__codelineno-25-37 name=__codelineno-25-37 href=#__codelineno-25-37></a><span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Dependency policy violations found:&#39;</span><span class=p>);</span>
</span><span id=__span-25-38><a id=__codelineno-25-38 name=__codelineno-25-38 href=#__codelineno-25-38></a><span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>const</span><span class=w> </span><span class=nx>violation</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=nx>violations</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-25-39><a id=__codelineno-25-39 name=__codelineno-25-39 href=#__codelineno-25-39></a><span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`- </span><span class=si>${</span><span class=nx>violation</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>: </span><span class=si>${</span><span class=nx>violation</span><span class=p>.</span><span class=nx>reason</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span><span id=__span-25-40><a id=__codelineno-25-40 name=__codelineno-25-40 href=#__codelineno-25-40></a><span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`  Suggestion: </span><span class=si>${</span><span class=nx>violation</span><span class=p>.</span><span class=nx>suggestion</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span><span id=__span-25-41><a id=__codelineno-25-41 name=__codelineno-25-41 href=#__codelineno-25-41></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-25-42><a id=__codelineno-25-42 name=__codelineno-25-42 href=#__codelineno-25-42></a><span class=w>  </span><span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mf>1</span><span class=p>);</span>
</span><span id=__span-25-43><a id=__codelineno-25-43 name=__codelineno-25-43 href=#__codelineno-25-43></a><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-25-44><a id=__codelineno-25-44 name=__codelineno-25-44 href=#__codelineno-25-44></a><span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;All dependencies comply with policy&#39;</span><span class=p>);</span>
</span><span id=__span-25-45><a id=__codelineno-25-45 name=__codelineno-25-45 href=#__codelineno-25-45></a><span class=p>}</span>
</span></code></pre></div> <h3 id=step-4-automated-dependency-update-strategy>Step 4: Automated Dependency Update Strategy<a class=headerlink href=#step-4-automated-dependency-update-strategy title="Permanent link">&para;</a></h3> <p>Implement a structured approach to dependency updates:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c1># Example Dependabot configuration</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=c1># .github/dependabot.yml</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=nt>updates</span><span class=p>:</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=w>  </span><span class=c1># Package ecosystem for npm</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>package-ecosystem</span><span class=p>:</span><span class=w> </span><span class=s>&quot;npm&quot;</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/&quot;</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=w>    </span><span class=nt>schedule</span><span class=p>:</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=w>      </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=s>&quot;weekly&quot;</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=w>      </span><span class=nt>day</span><span class=p>:</span><span class=w> </span><span class=s>&quot;monday&quot;</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=w>    </span><span class=c1># Group all dev dependencies into a single PR</span>
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=w>    </span><span class=nt>groups</span><span class=p>:</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=w>      </span><span class=nt>dev-dependencies</span><span class=p>:</span>
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=w>        </span><span class=nt>patterns</span><span class=p>:</span>
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;*eslint*&quot;</span>
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;*prettier*&quot;</span>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;*test*&quot;</span>
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;*webpack*&quot;</span>
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a><span class=w>    </span><span class=c1># Add reviewers</span>
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a><span class=w>    </span><span class=nt>reviewers</span><span class=p>:</span>
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;security-team&quot;</span>
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=w>    </span><span class=c1># Apply dependency labels</span>
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=w>    </span><span class=nt>labels</span><span class=p>:</span>
</span><span id=__span-26-24><a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;dependencies&quot;</span>
</span><span id=__span-26-25><a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;security&quot;</span>
</span><span id=__span-26-26><a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a><span class=w>    </span><span class=c1># Limit open PRs</span>
</span><span id=__span-26-27><a id=__codelineno-26-27 name=__codelineno-26-27 href=#__codelineno-26-27></a><span class=w>    </span><span class=nt>open-pull-requests-limit</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id=__span-26-28><a id=__codelineno-26-28 name=__codelineno-26-28 href=#__codelineno-26-28></a><span class=w>    </span><span class=c1># Special rules for version updates</span>
</span><span id=__span-26-29><a id=__codelineno-26-29 name=__codelineno-26-29 href=#__codelineno-26-29></a><span class=w>    </span><span class=nt>ignore</span><span class=p>:</span>
</span><span id=__span-26-30><a id=__codelineno-26-30 name=__codelineno-26-30 href=#__codelineno-26-30></a><span class=w>      </span><span class=c1># Don&#39;t update major versions automatically</span>
</span><span id=__span-26-31><a id=__codelineno-26-31 name=__codelineno-26-31 href=#__codelineno-26-31></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>dependency-name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;*&quot;</span>
</span><span id=__span-26-32><a id=__codelineno-26-32 name=__codelineno-26-32 href=#__codelineno-26-32></a><span class=w>        </span><span class=nt>update-types</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;version-update:semver-major&quot;</span><span class="p p-Indicator">]</span>
</span><span id=__span-26-33><a id=__codelineno-26-33 name=__codelineno-26-33 href=#__codelineno-26-33></a><span class=w>    </span><span class=c1># Auto-merge non-major updates for certain dependencies</span>
</span><span id=__span-26-34><a id=__codelineno-26-34 name=__codelineno-26-34 href=#__codelineno-26-34></a><span class=w>    </span><span class=nt>allow</span><span class=p>:</span>
</span><span id=__span-26-35><a id=__codelineno-26-35 name=__codelineno-26-35 href=#__codelineno-26-35></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>dependency-type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;direct&quot;</span>
</span><span id=__span-26-36><a id=__codelineno-26-36 name=__codelineno-26-36 href=#__codelineno-26-36></a><span class=w>        </span><span class=nt>dependency-name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;lodash&quot;</span>
</span><span id=__span-26-37><a id=__codelineno-26-37 name=__codelineno-26-37 href=#__codelineno-26-37></a><span class=w>        </span><span class=nt>update-types</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;version-update:semver-patch&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;version-update:semver-minor&quot;</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <p>Extend with custom update automation:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># Example custom dependency update script</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=kn>import</span> <span class=nn>os</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=kn>import</span> <span class=nn>json</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=kn>import</span> <span class=nn>subprocess</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=kn>import</span> <span class=nn>requests</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=k>def</span> <span class=nf>check_dependency_health</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>version</span><span class=p>):</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Check the health of a dependency.&quot;&quot;&quot;</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>    <span class=c1># Check GitHub repo stats</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>    <span class=n>repo_info</span> <span class=o>=</span> <span class=n>get_github_repo_info</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a>    <span class=c1># Check last commit date</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a>    <span class=n>last_commit_date</span> <span class=o>=</span> <span class=n>repo_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;last_commit_date&#39;</span><span class=p>)</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a>    <span class=k>if</span> <span class=n>last_commit_date</span><span class=p>:</span>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a>        <span class=n>last_commit_date</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>last_commit_date</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;Z&#39;</span><span class=p>,</span> <span class=s1>&#39;+00:00&#39;</span><span class=p>))</span>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a>        <span class=n>days_since_commit</span> <span class=o>=</span> <span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span> <span class=o>-</span> <span class=n>last_commit_date</span><span class=p>)</span><span class=o>.</span><span class=n>days</span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a>        <span class=k>if</span> <span class=n>days_since_commit</span> <span class=o>&gt;</span> <span class=mi>365</span><span class=p>:</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a>            <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;Last commit was </span><span class=si>{</span><span class=n>days_since_commit</span><span class=si>}</span><span class=s2> days ago&quot;</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a>
</span><span id=__span-27-21><a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a>    <span class=c1># Check open issues</span>
</span><span id=__span-27-22><a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a>    <span class=n>open_issues</span> <span class=o>=</span> <span class=n>repo_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;open_issues&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-27-23><a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a>    <span class=n>total_issues</span> <span class=o>=</span> <span class=n>repo_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;total_issues&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-27-24><a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a>    <span class=k>if</span> <span class=n>total_issues</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>open_issues</span> <span class=o>/</span> <span class=n>total_issues</span> <span class=o>&gt;</span> <span class=mf>0.8</span><span class=p>:</span>
</span><span id=__span-27-25><a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;High ratio of open issues: </span><span class=si>{</span><span class=n>open_issues</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_issues</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-27-26><a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a>
</span><span id=__span-27-27><a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a>    <span class=c1># Check security advisories</span>
</span><span id=__span-27-28><a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a>    <span class=n>advisories</span> <span class=o>=</span> <span class=n>get_security_advisories</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>version</span><span class=p>)</span>
</span><span id=__span-27-29><a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a>    <span class=k>if</span> <span class=n>advisories</span><span class=p>:</span>
</span><span id=__span-27-30><a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;Has </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>advisories</span><span class=p>)</span><span class=si>}</span><span class=s2> security advisories&quot;</span>
</span><span id=__span-27-31><a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a>
</span><span id=__span-27-32><a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a>    <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;Dependency is healthy&quot;</span>
</span><span id=__span-27-33><a id=__codelineno-27-33 name=__codelineno-27-33 href=#__codelineno-27-33></a>
</span><span id=__span-27-34><a id=__codelineno-27-34 name=__codelineno-27-34 href=#__codelineno-27-34></a><span class=k>def</span> <span class=nf>update_dependencies</span><span class=p>():</span>
</span><span id=__span-27-35><a id=__codelineno-27-35 name=__codelineno-27-35 href=#__codelineno-27-35></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Update dependencies based on health checks.&quot;&quot;&quot;</span>
</span><span id=__span-27-36><a id=__codelineno-27-36 name=__codelineno-27-36 href=#__codelineno-27-36></a>    <span class=c1># Load package.json</span>
</span><span id=__span-27-37><a id=__codelineno-27-37 name=__codelineno-27-37 href=#__codelineno-27-37></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;package.json&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-27-38><a id=__codelineno-27-38 name=__codelineno-27-38 href=#__codelineno-27-38></a>        <span class=n>package_json</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-27-39><a id=__codelineno-27-39 name=__codelineno-27-39 href=#__codelineno-27-39></a>
</span><span id=__span-27-40><a id=__codelineno-27-40 name=__codelineno-27-40 href=#__codelineno-27-40></a>    <span class=n>dependencies</span> <span class=o>=</span> <span class=n>package_json</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;dependencies&#39;</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-27-41><a id=__codelineno-27-41 name=__codelineno-27-41 href=#__codelineno-27-41></a>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-27-42><a id=__codelineno-27-42 name=__codelineno-27-42 href=#__codelineno-27-42></a>        <span class=s1>&#39;updated&#39;</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-27-43><a id=__codelineno-27-43 name=__codelineno-27-43 href=#__codelineno-27-43></a>        <span class=s1>&#39;skipped&#39;</span><span class=p>:</span> <span class=p>[]</span>
</span><span id=__span-27-44><a id=__codelineno-27-44 name=__codelineno-27-44 href=#__codelineno-27-44></a>    <span class=p>}</span>
</span><span id=__span-27-45><a id=__codelineno-27-45 name=__codelineno-27-45 href=#__codelineno-27-45></a>
</span><span id=__span-27-46><a id=__codelineno-27-46 name=__codelineno-27-46 href=#__codelineno-27-46></a>    <span class=k>for</span> <span class=n>dep_name</span><span class=p>,</span> <span class=n>current_version</span> <span class=ow>in</span> <span class=n>dependencies</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-27-47><a id=__codelineno-27-47 name=__codelineno-27-47 href=#__codelineno-27-47></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Checking </span><span class=si>{</span><span class=n>dep_name</span><span class=si>}</span><span class=s2>@</span><span class=si>{</span><span class=n>current_version</span><span class=si>}</span><span class=s2>...&quot;</span><span class=p>)</span>
</span><span id=__span-27-48><a id=__codelineno-27-48 name=__codelineno-27-48 href=#__codelineno-27-48></a>
</span><span id=__span-27-49><a id=__codelineno-27-49 name=__codelineno-27-49 href=#__codelineno-27-49></a>        <span class=c1># Get latest version</span>
</span><span id=__span-27-50><a id=__codelineno-27-50 name=__codelineno-27-50 href=#__codelineno-27-50></a>        <span class=n>latest_version</span> <span class=o>=</span> <span class=n>get_latest_version</span><span class=p>(</span><span class=n>dep_name</span><span class=p>)</span>
</span><span id=__span-27-51><a id=__codelineno-27-51 name=__codelineno-27-51 href=#__codelineno-27-51></a>
</span><span id=__span-27-52><a id=__codelineno-27-52 name=__codelineno-27-52 href=#__codelineno-27-52></a>        <span class=k>if</span> <span class=n>latest_version</span> <span class=o>==</span> <span class=n>current_version</span><span class=p>:</span>
</span><span id=__span-27-53><a id=__codelineno-27-53 name=__codelineno-27-53 href=#__codelineno-27-53></a>            <span class=n>results</span><span class=p>[</span><span class=s1>&#39;skipped&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-27-54><a id=__codelineno-27-54 name=__codelineno-27-54 href=#__codelineno-27-54></a>                <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>dep_name</span><span class=p>,</span>
</span><span id=__span-27-55><a id=__codelineno-27-55 name=__codelineno-27-55 href=#__codelineno-27-55></a>                <span class=s1>&#39;reason&#39;</span><span class=p>:</span> <span class=s1>&#39;Already at latest version&#39;</span>
</span><span id=__span-27-56><a id=__codelineno-27-56 name=__codelineno-27-56 href=#__codelineno-27-56></a>            <span class=p>})</span>
</span><span id=__span-27-57><a id=__codelineno-27-57 name=__codelineno-27-57 href=#__codelineno-27-57></a>            <span class=k>continue</span>
</span><span id=__span-27-58><a id=__codelineno-27-58 name=__codelineno-27-58 href=#__codelineno-27-58></a>
</span><span id=__span-27-59><a id=__codelineno-27-59 name=__codelineno-27-59 href=#__codelineno-27-59></a>        <span class=c1># Check dependency health</span>
</span><span id=__span-27-60><a id=__codelineno-27-60 name=__codelineno-27-60 href=#__codelineno-27-60></a>        <span class=n>is_healthy</span><span class=p>,</span> <span class=n>health_msg</span> <span class=o>=</span> <span class=n>check_dependency_health</span><span class=p>(</span><span class=n>dep_name</span><span class=p>,</span> <span class=n>latest_version</span><span class=p>)</span>
</span><span id=__span-27-61><a id=__codelineno-27-61 name=__codelineno-27-61 href=#__codelineno-27-61></a>
</span><span id=__span-27-62><a id=__codelineno-27-62 name=__codelineno-27-62 href=#__codelineno-27-62></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>is_healthy</span><span class=p>:</span>
</span><span id=__span-27-63><a id=__codelineno-27-63 name=__codelineno-27-63 href=#__codelineno-27-63></a>            <span class=n>results</span><span class=p>[</span><span class=s1>&#39;skipped&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-27-64><a id=__codelineno-27-64 name=__codelineno-27-64 href=#__codelineno-27-64></a>                <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>dep_name</span><span class=p>,</span>
</span><span id=__span-27-65><a id=__codelineno-27-65 name=__codelineno-27-65 href=#__codelineno-27-65></a>                <span class=s1>&#39;reason&#39;</span><span class=p>:</span> <span class=n>health_msg</span>
</span><span id=__span-27-66><a id=__codelineno-27-66 name=__codelineno-27-66 href=#__codelineno-27-66></a>            <span class=p>})</span>
</span><span id=__span-27-67><a id=__codelineno-27-67 name=__codelineno-27-67 href=#__codelineno-27-67></a>            <span class=k>continue</span>
</span><span id=__span-27-68><a id=__codelineno-27-68 name=__codelineno-27-68 href=#__codelineno-27-68></a>
</span><span id=__span-27-69><a id=__codelineno-27-69 name=__codelineno-27-69 href=#__codelineno-27-69></a>        <span class=c1># Update dependency</span>
</span><span id=__span-27-70><a id=__codelineno-27-70 name=__codelineno-27-70 href=#__codelineno-27-70></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-27-71><a id=__codelineno-27-71 name=__codelineno-27-71 href=#__codelineno-27-71></a>            <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s1>&#39;npm&#39;</span><span class=p>,</span> <span class=s1>&#39;install&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>dep_name</span><span class=si>}</span><span class=s1>@</span><span class=si>{</span><span class=n>latest_version</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>],</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-27-72><a id=__codelineno-27-72 name=__codelineno-27-72 href=#__codelineno-27-72></a>            <span class=n>results</span><span class=p>[</span><span class=s1>&#39;updated&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-27-73><a id=__codelineno-27-73 name=__codelineno-27-73 href=#__codelineno-27-73></a>                <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>dep_name</span><span class=p>,</span>
</span><span id=__span-27-74><a id=__codelineno-27-74 name=__codelineno-27-74 href=#__codelineno-27-74></a>                <span class=s1>&#39;from&#39;</span><span class=p>:</span> <span class=n>current_version</span><span class=p>,</span>
</span><span id=__span-27-75><a id=__codelineno-27-75 name=__codelineno-27-75 href=#__codelineno-27-75></a>                <span class=s1>&#39;to&#39;</span><span class=p>:</span> <span class=n>latest_version</span>
</span><span id=__span-27-76><a id=__codelineno-27-76 name=__codelineno-27-76 href=#__codelineno-27-76></a>            <span class=p>})</span>
</span><span id=__span-27-77><a id=__codelineno-27-77 name=__codelineno-27-77 href=#__codelineno-27-77></a>        <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>CalledProcessError</span><span class=p>:</span>
</span><span id=__span-27-78><a id=__codelineno-27-78 name=__codelineno-27-78 href=#__codelineno-27-78></a>            <span class=n>results</span><span class=p>[</span><span class=s1>&#39;skipped&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-27-79><a id=__codelineno-27-79 name=__codelineno-27-79 href=#__codelineno-27-79></a>                <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>dep_name</span><span class=p>,</span>
</span><span id=__span-27-80><a id=__codelineno-27-80 name=__codelineno-27-80 href=#__codelineno-27-80></a>                <span class=s1>&#39;reason&#39;</span><span class=p>:</span> <span class=s1>&#39;Installation failed&#39;</span>
</span><span id=__span-27-81><a id=__codelineno-27-81 name=__codelineno-27-81 href=#__codelineno-27-81></a>            <span class=p>})</span>
</span><span id=__span-27-82><a id=__codelineno-27-82 name=__codelineno-27-82 href=#__codelineno-27-82></a>
</span><span id=__span-27-83><a id=__codelineno-27-83 name=__codelineno-27-83 href=#__codelineno-27-83></a>    <span class=c1># Output results</span>
</span><span id=__span-27-84><a id=__codelineno-27-84 name=__codelineno-27-84 href=#__codelineno-27-84></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Updated </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;updated&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2> dependencies:&quot;</span><span class=p>)</span>
</span><span id=__span-27-85><a id=__codelineno-27-85 name=__codelineno-27-85 href=#__codelineno-27-85></a>    <span class=k>for</span> <span class=n>dep</span> <span class=ow>in</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;updated&#39;</span><span class=p>]:</span>
</span><span id=__span-27-86><a id=__codelineno-27-86 name=__codelineno-27-86 href=#__codelineno-27-86></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>dep</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>dep</span><span class=p>[</span><span class=s1>&#39;from&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>dep</span><span class=p>[</span><span class=s1>&#39;to&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-27-87><a id=__codelineno-27-87 name=__codelineno-27-87 href=#__codelineno-27-87></a>
</span><span id=__span-27-88><a id=__codelineno-27-88 name=__codelineno-27-88 href=#__codelineno-27-88></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Skipped </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;skipped&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2> dependencies:&quot;</span><span class=p>)</span>
</span><span id=__span-27-89><a id=__codelineno-27-89 name=__codelineno-27-89 href=#__codelineno-27-89></a>    <span class=k>for</span> <span class=n>dep</span> <span class=ow>in</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;skipped&#39;</span><span class=p>]:</span>
</span><span id=__span-27-90><a id=__codelineno-27-90 name=__codelineno-27-90 href=#__codelineno-27-90></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>dep</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>dep</span><span class=p>[</span><span class=s1>&#39;reason&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-27-91><a id=__codelineno-27-91 name=__codelineno-27-91 href=#__codelineno-27-91></a>
</span><span id=__span-27-92><a id=__codelineno-27-92 name=__codelineno-27-92 href=#__codelineno-27-92></a>    <span class=c1># Run tests to verify updates</span>
</span><span id=__span-27-93><a id=__codelineno-27-93 name=__codelineno-27-93 href=#__codelineno-27-93></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-27-94><a id=__codelineno-27-94 name=__codelineno-27-94 href=#__codelineno-27-94></a>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s1>&#39;npm&#39;</span><span class=p>,</span> <span class=s1>&#39;test&#39;</span><span class=p>],</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-27-95><a id=__codelineno-27-95 name=__codelineno-27-95 href=#__codelineno-27-95></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2> Tests passed with updated dependencies&quot;</span><span class=p>)</span>
</span><span id=__span-27-96><a id=__codelineno-27-96 name=__codelineno-27-96 href=#__codelineno-27-96></a>    <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>CalledProcessError</span><span class=p>:</span>
</span><span id=__span-27-97><a id=__codelineno-27-97 name=__codelineno-27-97 href=#__codelineno-27-97></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2> Tests failed with updated dependencies&quot;</span><span class=p>)</span>
</span><span id=__span-27-98><a id=__codelineno-27-98 name=__codelineno-27-98 href=#__codelineno-27-98></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Rolling back changes...&quot;</span><span class=p>)</span>
</span><span id=__span-27-99><a id=__codelineno-27-99 name=__codelineno-27-99 href=#__codelineno-27-99></a>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s1>&#39;git&#39;</span><span class=p>,</span> <span class=s1>&#39;checkout&#39;</span><span class=p>,</span> <span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=s1>&#39;package.json&#39;</span><span class=p>,</span> <span class=s1>&#39;package-lock.json&#39;</span><span class=p>])</span>
</span><span id=__span-27-100><a id=__codelineno-27-100 name=__codelineno-27-100 href=#__codelineno-27-100></a>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s1>&#39;npm&#39;</span><span class=p>,</span> <span class=s1>&#39;ci&#39;</span><span class=p>])</span>
</span></code></pre></div> <h3 id=step-5-dependency-monitoring-and-incident-response>Step 5: Dependency Monitoring and Incident Response<a class=headerlink href=#step-5-dependency-monitoring-and-incident-response title="Permanent link">&para;</a></h3> <p>Set up continuous monitoring for dependency issues:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># Example GitHub Action for dependency monitoring</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Dependency Monitoring</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=nt>on</span><span class=p>:</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=w>  </span><span class=nt>schedule</span><span class=p>:</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>cron</span><span class=p>:</span><span class=w> </span><span class=s>&#39;0</span><span class=nv> </span><span class=s>*/6</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*&#39;</span><span class=w>  </span><span class=c1># Run every 6 hours</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=w>  </span><span class=nt>workflow_dispatch</span><span class=p>:</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=nt>jobs</span><span class=p>:</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=w>  </span><span class=nt>monitor</span><span class=p>:</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Set up Node.js</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-node@v3</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a><span class=w>        </span><span class=nt>with</span><span class=p>:</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a><span class=w>          </span><span class=nt>node-version</span><span class=p>:</span><span class=w> </span><span class=s>&#39;18&#39;</span>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">npm ci</span>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Check for new vulnerabilities</span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">audit</span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a><span class=w>          </span><span class=no># Get previous audit</span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a><span class=w>          </span><span class=no>if [[ -f .audit-baseline.json ]]; then</span>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a><span class=w>            </span><span class=no>cp .audit-baseline.json previous-audit.json</span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a><span class=w>          </span><span class=no>else</span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a><span class=w>            </span><span class=no>echo &quot;{}&quot; &gt; previous-audit.json</span>
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a><span class=w>          </span><span class=no>fi</span>
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32 href=#__codelineno-28-32></a>
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33 href=#__codelineno-28-33></a><span class=w>          </span><span class=no># Run new audit</span>
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34 href=#__codelineno-28-34></a><span class=w>          </span><span class=no>npm audit --json &gt; current-audit.json</span>
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35 href=#__codelineno-28-35></a>
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36 href=#__codelineno-28-36></a><span class=w>          </span><span class=no># Compare for new issues</span>
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37 href=#__codelineno-28-37></a><span class=w>          </span><span class=no>node .github/scripts/compare-audits.js \</span>
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38 href=#__codelineno-28-38></a><span class=w>            </span><span class=no>previous-audit.json current-audit.json &gt; new-vulns.json</span>
</span><span id=__span-28-39><a id=__codelineno-28-39 name=__codelineno-28-39 href=#__codelineno-28-39></a>
</span><span id=__span-28-40><a id=__codelineno-28-40 name=__codelineno-28-40 href=#__codelineno-28-40></a><span class=w>          </span><span class=no># Save current audit as baseline</span>
</span><span id=__span-28-41><a id=__codelineno-28-41 name=__codelineno-28-41 href=#__codelineno-28-41></a><span class=w>          </span><span class=no>cp current-audit.json .audit-baseline.json</span>
</span><span id=__span-28-42><a id=__codelineno-28-42 name=__codelineno-28-42 href=#__codelineno-28-42></a>
</span><span id=__span-28-43><a id=__codelineno-28-43 name=__codelineno-28-43 href=#__codelineno-28-43></a><span class=w>          </span><span class=no># Check if new vulnerabilities found</span>
</span><span id=__span-28-44><a id=__codelineno-28-44 name=__codelineno-28-44 href=#__codelineno-28-44></a><span class=w>          </span><span class=no>NEW_VULNS=$(jq &#39;length&#39; new-vulns.json)</span>
</span><span id=__span-28-45><a id=__codelineno-28-45 name=__codelineno-28-45 href=#__codelineno-28-45></a><span class=w>          </span><span class=no>echo &quot;new_vulns=$NEW_VULNS&quot; &gt;&gt; $GITHUB_OUTPUT</span>
</span><span id=__span-28-46><a id=__codelineno-28-46 name=__codelineno-28-46 href=#__codelineno-28-46></a>
</span><span id=__span-28-47><a id=__codelineno-28-47 name=__codelineno-28-47 href=#__codelineno-28-47></a><span class=w>          </span><span class=no>if [[ &quot;$NEW_VULNS&quot; -gt 0 ]]; then</span>
</span><span id=__span-28-48><a id=__codelineno-28-48 name=__codelineno-28-48 href=#__codelineno-28-48></a><span class=w>            </span><span class=no>echo &quot; New vulnerabilities detected&quot;</span>
</span><span id=__span-28-49><a id=__codelineno-28-49 name=__codelineno-28-49 href=#__codelineno-28-49></a><span class=w>            </span><span class=no>jq &#39;.&#39; new-vulns.json</span>
</span><span id=__span-28-50><a id=__codelineno-28-50 name=__codelineno-28-50 href=#__codelineno-28-50></a><span class=w>          </span><span class=no>else</span>
</span><span id=__span-28-51><a id=__codelineno-28-51 name=__codelineno-28-51 href=#__codelineno-28-51></a><span class=w>            </span><span class=no>echo &quot; No new vulnerabilities&quot;</span>
</span><span id=__span-28-52><a id=__codelineno-28-52 name=__codelineno-28-52 href=#__codelineno-28-52></a><span class=w>          </span><span class=no>fi</span>
</span><span id=__span-28-53><a id=__codelineno-28-53 name=__codelineno-28-53 href=#__codelineno-28-53></a>
</span><span id=__span-28-54><a id=__codelineno-28-54 name=__codelineno-28-54 href=#__codelineno-28-54></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Create issue for new vulnerabilities</span>
</span><span id=__span-28-55><a id=__codelineno-28-55 name=__codelineno-28-55 href=#__codelineno-28-55></a><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">steps.audit.outputs.new_vulns != &#39;0&#39;</span>
</span><span id=__span-28-56><a id=__codelineno-28-56 name=__codelineno-28-56 href=#__codelineno-28-56></a><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">JasonEtco/create-an-issue@v2</span>
</span><span id=__span-28-57><a id=__codelineno-28-57 name=__codelineno-28-57 href=#__codelineno-28-57></a><span class=w>        </span><span class=nt>env</span><span class=p>:</span>
</span><span id=__span-28-58><a id=__codelineno-28-58 name=__codelineno-28-58 href=#__codelineno-28-58></a><span class=w>          </span><span class=nt>GITHUB_TOKEN</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
</span><span id=__span-28-59><a id=__codelineno-28-59 name=__codelineno-28-59 href=#__codelineno-28-59></a><span class=w>        </span><span class=nt>with</span><span class=p>:</span>
</span><span id=__span-28-60><a id=__codelineno-28-60 name=__codelineno-28-60 href=#__codelineno-28-60></a><span class=w>          </span><span class=nt>filename</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">.github/VULNERABILITY_ISSUE_TEMPLATE.md</span>
</span><span id=__span-28-61><a id=__codelineno-28-61 name=__codelineno-28-61 href=#__codelineno-28-61></a><span class=w>          </span><span class=nt>update_existing</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-28-62><a id=__codelineno-28-62 name=__codelineno-28-62 href=#__codelineno-28-62></a>
</span><span id=__span-28-63><a id=__codelineno-28-63 name=__codelineno-28-63 href=#__codelineno-28-63></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Commit updated baseline</span>
</span><span id=__span-28-64><a id=__codelineno-28-64 name=__codelineno-28-64 href=#__codelineno-28-64></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-28-65><a id=__codelineno-28-65 name=__codelineno-28-65 href=#__codelineno-28-65></a><span class=w>          </span><span class=no>git config user.name &quot;Dependency Monitor&quot;</span>
</span><span id=__span-28-66><a id=__codelineno-28-66 name=__codelineno-28-66 href=#__codelineno-28-66></a><span class=w>          </span><span class=no>git config user.email &quot;bot@example.com&quot;</span>
</span><span id=__span-28-67><a id=__codelineno-28-67 name=__codelineno-28-67 href=#__codelineno-28-67></a><span class=w>          </span><span class=no>git add .audit-baseline.json</span>
</span><span id=__span-28-68><a id=__codelineno-28-68 name=__codelineno-28-68 href=#__codelineno-28-68></a><span class=w>          </span><span class=no>git commit -m &quot;Update vulnerability audit baseline&quot; || echo &quot;No changes to commit&quot;</span>
</span><span id=__span-28-69><a id=__codelineno-28-69 name=__codelineno-28-69 href=#__codelineno-28-69></a><span class=w>          </span><span class=no>git push</span>
</span></code></pre></div> <p>Create a dependency incident response plan:</p> <div class="language-markdown highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=gh># Dependency Incident Response Plan</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=gu>## Incident Types</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=k>1.</span> Critical vulnerability discovered in dependency
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=k>2.</span> Dependency compromised (malicious code insertion)
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=k>3.</span> Dependency abandoned/deprecated
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=k>4.</span> License change in dependency
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=gu>## Response Team</span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=k>-</span><span class=w> </span>Security Engineer (lead)
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=k>-</span><span class=w> </span>Application Developer
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=k>-</span><span class=w> </span>DevOps Engineer
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=k>-</span><span class=w> </span>Product Manager
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a><span class=gu>## Response Process</span>
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a>
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a><span class=gu>### 1. Detect &amp; Alert</span>
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a><span class=k>-</span><span class=w> </span>Automated detection via monitoring tools
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a><span class=k>-</span><span class=w> </span>Manual reports from security mailing lists
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a><span class=k>-</span><span class=w> </span>Bug bounty reports
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>
</span><span id=__span-29-22><a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a><span class=gu>### 2. Assess &amp; Triage</span>
</span><span id=__span-29-23><a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a><span class=k>-</span><span class=w> </span>Determine affected applications
</span><span id=__span-29-24><a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a><span class=k>-</span><span class=w> </span>Assess technical impact
</span><span id=__span-29-25><a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a><span class=k>-</span><span class=w> </span>Evaluate exploitability
</span><span id=__span-29-26><a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a><span class=k>-</span><span class=w> </span>Assign severity level
</span><span id=__span-29-27><a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a>
</span><span id=__span-29-28><a id=__codelineno-29-28 name=__codelineno-29-28 href=#__codelineno-29-28></a><span class=gu>### 3. Contain &amp; Mitigate</span>
</span><span id=__span-29-29><a id=__codelineno-29-29 name=__codelineno-29-29 href=#__codelineno-29-29></a><span class=gs>**For Critical/High severity:**</span>
</span><span id=__span-29-30><a id=__codelineno-29-30 name=__codelineno-29-30 href=#__codelineno-29-30></a><span class=k>-</span><span class=w> </span>Implement temporary workarounds
</span><span id=__span-29-31><a id=__codelineno-29-31 name=__codelineno-29-31 href=#__codelineno-29-31></a><span class=k>-</span><span class=w> </span>Consider emergency rollback if actively exploited
</span><span id=__span-29-32><a id=__codelineno-29-32 name=__codelineno-29-32 href=#__codelineno-29-32></a><span class=k>-</span><span class=w> </span>Pin to last known good version
</span><span id=__span-29-33><a id=__codelineno-29-33 name=__codelineno-29-33 href=#__codelineno-29-33></a>
</span><span id=__span-29-34><a id=__codelineno-29-34 name=__codelineno-29-34 href=#__codelineno-29-34></a><span class=gs>**For Medium/Low severity:**</span>
</span><span id=__span-29-35><a id=__codelineno-29-35 name=__codelineno-29-35 href=#__codelineno-29-35></a><span class=k>-</span><span class=w> </span>Schedule normal update cycle
</span><span id=__span-29-36><a id=__codelineno-29-36 name=__codelineno-29-36 href=#__codelineno-29-36></a><span class=k>-</span><span class=w> </span>Document in vulnerability tracking system
</span><span id=__span-29-37><a id=__codelineno-29-37 name=__codelineno-29-37 href=#__codelineno-29-37></a>
</span><span id=__span-29-38><a id=__codelineno-29-38 name=__codelineno-29-38 href=#__codelineno-29-38></a><span class=gu>### 4. Remediate</span>
</span><span id=__span-29-39><a id=__codelineno-29-39 name=__codelineno-29-39 href=#__codelineno-29-39></a><span class=k>-</span><span class=w> </span>Update to fixed version
</span><span id=__span-29-40><a id=__codelineno-29-40 name=__codelineno-29-40 href=#__codelineno-29-40></a><span class=k>-</span><span class=w> </span>Remove vulnerable dependency
</span><span id=__span-29-41><a id=__codelineno-29-41 name=__codelineno-29-41 href=#__codelineno-29-41></a><span class=k>-</span><span class=w> </span>Replace with alternative
</span><span id=__span-29-42><a id=__codelineno-29-42 name=__codelineno-29-42 href=#__codelineno-29-42></a><span class=k>-</span><span class=w> </span>Implement custom patch if needed
</span><span id=__span-29-43><a id=__codelineno-29-43 name=__codelineno-29-43 href=#__codelineno-29-43></a>
</span><span id=__span-29-44><a id=__codelineno-29-44 name=__codelineno-29-44 href=#__codelineno-29-44></a><span class=gu>### 5. Verify &amp; Close</span>
</span><span id=__span-29-45><a id=__codelineno-29-45 name=__codelineno-29-45 href=#__codelineno-29-45></a><span class=k>-</span><span class=w> </span>Validate fix effectiveness
</span><span id=__span-29-46><a id=__codelineno-29-46 name=__codelineno-29-46 href=#__codelineno-29-46></a><span class=k>-</span><span class=w> </span>Run regression tests
</span><span id=__span-29-47><a id=__codelineno-29-47 name=__codelineno-29-47 href=#__codelineno-29-47></a><span class=k>-</span><span class=w> </span>Update dependency inventory
</span><span id=__span-29-48><a id=__codelineno-29-48 name=__codelineno-29-48 href=#__codelineno-29-48></a><span class=k>-</span><span class=w> </span>Document lessons learned
</span><span id=__span-29-49><a id=__codelineno-29-49 name=__codelineno-29-49 href=#__codelineno-29-49></a>
</span><span id=__span-29-50><a id=__codelineno-29-50 name=__codelineno-29-50 href=#__codelineno-29-50></a><span class=gu>## Emergency Contact List</span>
</span><span id=__span-29-51><a id=__codelineno-29-51 name=__codelineno-29-51 href=#__codelineno-29-51></a><span class=k>-</span><span class=w> </span>Security Team: security@example.com
</span><span id=__span-29-52><a id=__codelineno-29-52 name=__codelineno-29-52 href=#__codelineno-29-52></a><span class=k>-</span><span class=w> </span>On-call Engineer: +1-555-123-4567
</span><span id=__span-29-53><a id=__codelineno-29-53 name=__codelineno-29-53 href=#__codelineno-29-53></a><span class=k>-</span><span class=w> </span>Slack Channel: <span class=ni>#dependency</span>-emergencies
</span></code></pre></div> <h2 id=specialized-dependency-management-approaches>Specialized Dependency Management Approaches<a class=headerlink href=#specialized-dependency-management-approaches title="Permanent link">&para;</a></h2> <h3 id=monorepo-dependency-management>Monorepo Dependency Management<a class=headerlink href=#monorepo-dependency-management title="Permanent link">&para;</a></h3> <p>In monorepo environments, dependencies must be managed across multiple projects:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=c1>// Example workspace configuration for Yarn</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=p>{</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=w>  </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;monorepo-root&quot;</span><span class=p>,</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=w>  </span><span class=nt>&quot;private&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=w>  </span><span class=nt>&quot;workspaces&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=w>    </span><span class=s2>&quot;packages/*&quot;</span><span class=p>,</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=w>    </span><span class=s2>&quot;apps/*&quot;</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=w>  </span><span class=p>],</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=w>  </span><span class=nt>&quot;scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=w>    </span><span class=nt>&quot;audit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;yarn-workspace-audit&quot;</span><span class=p>,</span>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a><span class=w>    </span><span class=nt>&quot;update-deps&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;yarn upgrade-interactive&quot;</span><span class=p>,</span>
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a><span class=w>    </span><span class=nt>&quot;clean&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;yarn clean:modules &amp;&amp; yarn clean:builds&quot;</span><span class=p>,</span>
</span><span id=__span-30-13><a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a><span class=w>    </span><span class=nt>&quot;clean:modules&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;find . -name &#39;node_modules&#39; -type d -prune -exec rm -rf &#39;{}&#39; +&quot;</span><span class=p>,</span>
</span><span id=__span-30-14><a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a><span class=w>    </span><span class=nt>&quot;clean:builds&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;find . -name &#39;dist&#39; -type d -prune -exec rm -rf &#39;{}&#39; +&quot;</span>
</span><span id=__span-30-15><a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-30-16><a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a><span class=w>  </span><span class=nt>&quot;devDependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-30-17><a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=w>    </span><span class=nt>&quot;yarn-workspace-audit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;^1.0.0&quot;</span>
</span><span id=__span-30-18><a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-30-19><a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a><span class=w>  </span><span class=nt>&quot;resolutions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-30-20><a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a><span class=w>    </span><span class=nt>&quot;lodash&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;4.17.21&quot;</span><span class=p>,</span>
</span><span id=__span-30-21><a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a><span class=w>    </span><span class=nt>&quot;minimist&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.2.6&quot;</span>
</span><span id=__span-30-22><a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-30-23><a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a><span class=p>}</span>
</span></code></pre></div> <h3 id=microservice-dependency-management>Microservice Dependency Management<a class=headerlink href=#microservice-dependency-management title="Permanent link">&para;</a></h3> <p>For microservice architectures:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># Example microservice dependency management workflow</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Coordinated Dependency Updates</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=nt>on</span><span class=p>:</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>  </span><span class=nt>workflow_dispatch</span><span class=p>:</span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=w>  </span><span class=nt>schedule</span><span class=p>:</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>cron</span><span class=p>:</span><span class=w> </span><span class=s>&#39;0</span><span class=nv> </span><span class=s>0</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>1&#39;</span><span class=w>  </span><span class=c1># Weekly on Mondays</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=nt>jobs</span><span class=p>:</span>
</span><span id=__span-31-10><a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=w>  </span><span class=nt>analyze-dependencies</span><span class=p>:</span>
</span><span id=__span-31-11><a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</span><span id=__span-31-12><a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a><span class=w>    </span><span class=nt>outputs</span><span class=p>:</span>
</span><span id=__span-31-13><a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a><span class=w>      </span><span class=nt>update-matrix</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">${{ steps.generate-matrix.outputs.update-matrix }}</span>
</span><span id=__span-31-14><a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a>
</span><span id=__span-31-15><a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-31-16><a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
</span><span id=__span-31-17><a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a>
</span><span id=__span-31-18><a id=__codelineno-31-18 name=__codelineno-31-18 href=#__codelineno-31-18></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Discover services</span>
</span><span id=__span-31-19><a id=__codelineno-31-19 name=__codelineno-31-19 href=#__codelineno-31-19></a><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">discover</span>
</span><span id=__span-31-20><a id=__codelineno-31-20 name=__codelineno-31-20 href=#__codelineno-31-20></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-31-21><a id=__codelineno-31-21 name=__codelineno-31-21 href=#__codelineno-31-21></a><span class=w>          </span><span class=no>echo &quot;services=$(ls -d services/* | jq -R -s -c &#39;split(&quot;\n&quot;)[:-1]&#39;)&quot; &gt;&gt; $GITHUB_OUTPUT</span>
</span><span id=__span-31-22><a id=__codelineno-31-22 name=__codelineno-31-22 href=#__codelineno-31-22></a>
</span><span id=__span-31-23><a id=__codelineno-31-23 name=__codelineno-31-23 href=#__codelineno-31-23></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Analyze dependencies across services</span>
</span><span id=__span-31-24><a id=__codelineno-31-24 name=__codelineno-31-24 href=#__codelineno-31-24></a><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyze</span>
</span><span id=__span-31-25><a id=__codelineno-31-25 name=__codelineno-31-25 href=#__codelineno-31-25></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-31-26><a id=__codelineno-31-26 name=__codelineno-31-26 href=#__codelineno-31-26></a><span class=w>          </span><span class=no>python .github/scripts/analyze_common_deps.py \</span>
</span><span id=__span-31-27><a id=__codelineno-31-27 name=__codelineno-31-27 href=#__codelineno-31-27></a><span class=w>            </span><span class=no>--services &#39;${{ steps.discover.outputs.services }}&#39; \</span>
</span><span id=__span-31-28><a id=__codelineno-31-28 name=__codelineno-31-28 href=#__codelineno-31-28></a><span class=w>            </span><span class=no>--output &#39;dep-analysis.json&#39;</span>
</span><span id=__span-31-29><a id=__codelineno-31-29 name=__codelineno-31-29 href=#__codelineno-31-29></a>
</span><span id=__span-31-30><a id=__codelineno-31-30 name=__codelineno-31-30 href=#__codelineno-31-30></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Generate update matrix</span>
</span><span id=__span-31-31><a id=__codelineno-31-31 name=__codelineno-31-31 href=#__codelineno-31-31></a><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">generate-matrix</span>
</span><span id=__span-31-32><a id=__codelineno-31-32 name=__codelineno-31-32 href=#__codelineno-31-32></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-31-33><a id=__codelineno-31-33 name=__codelineno-31-33 href=#__codelineno-31-33></a><span class=w>          </span><span class=no>UPDATE_MATRIX=$(jq -c &#39;{service: .services, dependency: .common_dependencies}&#39; dep-analysis.json)</span>
</span><span id=__span-31-34><a id=__codelineno-31-34 name=__codelineno-31-34 href=#__codelineno-31-34></a><span class=w>          </span><span class=no>echo &quot;update-matrix=${UPDATE_MATRIX}&quot; &gt;&gt; $GITHUB_OUTPUT</span>
</span><span id=__span-31-35><a id=__codelineno-31-35 name=__codelineno-31-35 href=#__codelineno-31-35></a>
</span><span id=__span-31-36><a id=__codelineno-31-36 name=__codelineno-31-36 href=#__codelineno-31-36></a><span class=w>  </span><span class=nt>update-dependencies</span><span class=p>:</span>
</span><span id=__span-31-37><a id=__codelineno-31-37 name=__codelineno-31-37 href=#__codelineno-31-37></a><span class=w>    </span><span class=nt>needs</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyze-dependencies</span>
</span><span id=__span-31-38><a id=__codelineno-31-38 name=__codelineno-31-38 href=#__codelineno-31-38></a><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</span><span id=__span-31-39><a id=__codelineno-31-39 name=__codelineno-31-39 href=#__codelineno-31-39></a><span class=w>    </span><span class=nt>strategy</span><span class=p>:</span>
</span><span id=__span-31-40><a id=__codelineno-31-40 name=__codelineno-31-40 href=#__codelineno-31-40></a><span class=w>      </span><span class=nt>matrix</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">${{ fromJson(needs.analyze-dependencies.outputs.update-matrix) }}</span>
</span><span id=__span-31-41><a id=__codelineno-31-41 name=__codelineno-31-41 href=#__codelineno-31-41></a><span class=w>      </span><span class=nt>fail-fast</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id=__span-31-42><a id=__codelineno-31-42 name=__codelineno-31-42 href=#__codelineno-31-42></a>
</span><span id=__span-31-43><a id=__codelineno-31-43 name=__codelineno-31-43 href=#__codelineno-31-43></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-31-44><a id=__codelineno-31-44 name=__codelineno-31-44 href=#__codelineno-31-44></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
</span><span id=__span-31-45><a id=__codelineno-31-45 name=__codelineno-31-45 href=#__codelineno-31-45></a>
</span><span id=__span-31-46><a id=__codelineno-31-46 name=__codelineno-31-46 href=#__codelineno-31-46></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Set up environment</span>
</span><span id=__span-31-47><a id=__codelineno-31-47 name=__codelineno-31-47 href=#__codelineno-31-47></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-31-48><a id=__codelineno-31-48 name=__codelineno-31-48 href=#__codelineno-31-48></a><span class=w>          </span><span class=no>cd ${{ matrix.service }}</span>
</span><span id=__span-31-49><a id=__codelineno-31-49 name=__codelineno-31-49 href=#__codelineno-31-49></a><span class=w>          </span><span class=no># Install dependencies based on service type</span>
</span><span id=__span-31-50><a id=__codelineno-31-50 name=__codelineno-31-50 href=#__codelineno-31-50></a><span class=w>          </span><span class=no>if [ -f package.json ]; then</span>
</span><span id=__span-31-51><a id=__codelineno-31-51 name=__codelineno-31-51 href=#__codelineno-31-51></a><span class=w>            </span><span class=no>npm ci</span>
</span><span id=__span-31-52><a id=__codelineno-31-52 name=__codelineno-31-52 href=#__codelineno-31-52></a><span class=w>          </span><span class=no>elif [ -f requirements.txt ]; then</span>
</span><span id=__span-31-53><a id=__codelineno-31-53 name=__codelineno-31-53 href=#__codelineno-31-53></a><span class=w>            </span><span class=no>pip install -r requirements.txt</span>
</span><span id=__span-31-54><a id=__codelineno-31-54 name=__codelineno-31-54 href=#__codelineno-31-54></a><span class=w>          </span><span class=no>fi</span>
</span><span id=__span-31-55><a id=__codelineno-31-55 name=__codelineno-31-55 href=#__codelineno-31-55></a>
</span><span id=__span-31-56><a id=__codelineno-31-56 name=__codelineno-31-56 href=#__codelineno-31-56></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Update dependency</span>
</span><span id=__span-31-57><a id=__codelineno-31-57 name=__codelineno-31-57 href=#__codelineno-31-57></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-31-58><a id=__codelineno-31-58 name=__codelineno-31-58 href=#__codelineno-31-58></a><span class=w>          </span><span class=no>cd ${{ matrix.service }}</span>
</span><span id=__span-31-59><a id=__codelineno-31-59 name=__codelineno-31-59 href=#__codelineno-31-59></a><span class=w>          </span><span class=no># Update dependency based on service type</span>
</span><span id=__span-31-60><a id=__codelineno-31-60 name=__codelineno-31-60 href=#__codelineno-31-60></a><span class=w>          </span><span class=no>if [ -f package.json ]; then</span>
</span><span id=__span-31-61><a id=__codelineno-31-61 name=__codelineno-31-61 href=#__codelineno-31-61></a><span class=w>            </span><span class=no>npm update ${{ matrix.dependency }} --save</span>
</span><span id=__span-31-62><a id=__codelineno-31-62 name=__codelineno-31-62 href=#__codelineno-31-62></a><span class=w>          </span><span class=no>elif [ -f requirements.txt ]; then</span>
</span><span id=__span-31-63><a id=__codelineno-31-63 name=__codelineno-31-63 href=#__codelineno-31-63></a><span class=w>            </span><span class=no>pip install --upgrade ${{ matrix.dependency }}</span>
</span><span id=__span-31-64><a id=__codelineno-31-64 name=__codelineno-31-64 href=#__codelineno-31-64></a><span class=w>            </span><span class=no>pip freeze &gt; requirements.txt</span>
</span><span id=__span-31-65><a id=__codelineno-31-65 name=__codelineno-31-65 href=#__codelineno-31-65></a><span class=w>          </span><span class=no>fi</span>
</span><span id=__span-31-66><a id=__codelineno-31-66 name=__codelineno-31-66 href=#__codelineno-31-66></a>
</span><span id=__span-31-67><a id=__codelineno-31-67 name=__codelineno-31-67 href=#__codelineno-31-67></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Run tests</span>
</span><span id=__span-31-68><a id=__codelineno-31-68 name=__codelineno-31-68 href=#__codelineno-31-68></a><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-31-69><a id=__codelineno-31-69 name=__codelineno-31-69 href=#__codelineno-31-69></a><span class=w>          </span><span class=no>cd ${{ matrix.service }}</span>
</span><span id=__span-31-70><a id=__codelineno-31-70 name=__codelineno-31-70 href=#__codelineno-31-70></a><span class=w>          </span><span class=no># Run tests based on service type</span>
</span><span id=__span-31-71><a id=__codelineno-31-71 name=__codelineno-31-71 href=#__codelineno-31-71></a><span class=w>          </span><span class=no>if [ -f package.json ]; then</span>
</span><span id=__span-31-72><a id=__codelineno-31-72 name=__codelineno-31-72 href=#__codelineno-31-72></a><span class=w>            </span><span class=no>npm test</span>
</span><span id=__span-31-73><a id=__codelineno-31-73 name=__codelineno-31-73 href=#__codelineno-31-73></a><span class=w>          </span><span class=no>elif [ -f requirements.txt ]; then</span>
</span><span id=__span-31-74><a id=__codelineno-31-74 name=__codelineno-31-74 href=#__codelineno-31-74></a><span class=w>            </span><span class=no>pytest</span>
</span><span id=__span-31-75><a id=__codelineno-31-75 name=__codelineno-31-75 href=#__codelineno-31-75></a><span class=w>          </span><span class=no>fi</span>
</span><span id=__span-31-76><a id=__codelineno-31-76 name=__codelineno-31-76 href=#__codelineno-31-76></a>
</span><span id=__span-31-77><a id=__codelineno-31-77 name=__codelineno-31-77 href=#__codelineno-31-77></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Create PR for update</span>
</span><span id=__span-31-78><a id=__codelineno-31-78 name=__codelineno-31-78 href=#__codelineno-31-78></a><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">peter-evans/create-pull-request@v4</span>
</span><span id=__span-31-79><a id=__codelineno-31-79 name=__codelineno-31-79 href=#__codelineno-31-79></a><span class=w>        </span><span class=nt>with</span><span class=p>:</span>
</span><span id=__span-31-80><a id=__codelineno-31-80 name=__codelineno-31-80 href=#__codelineno-31-80></a><span class=w>          </span><span class=nt>branch</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">update-${{ matrix.dependency }}-${{ matrix.service }}</span>
</span><span id=__span-31-81><a id=__codelineno-31-81 name=__codelineno-31-81 href=#__codelineno-31-81></a><span class=w>          </span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Update</span><span class=nv> </span><span class=s>${{</span><span class=nv> </span><span class=s>matrix.dependency</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>in</span><span class=nv> </span><span class=s>${{</span><span class=nv> </span><span class=s>matrix.service</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-31-82><a id=__codelineno-31-82 name=__codelineno-31-82 href=#__codelineno-31-82></a><span class=w>          </span><span class=nt>body</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-31-83><a id=__codelineno-31-83 name=__codelineno-31-83 href=#__codelineno-31-83></a><span class=w>            </span><span class=no>This PR updates ${{ matrix.dependency }} to the latest version in ${{ matrix.service }}.</span>
</span><span id=__span-31-84><a id=__codelineno-31-84 name=__codelineno-31-84 href=#__codelineno-31-84></a>
</span><span id=__span-31-85><a id=__codelineno-31-85 name=__codelineno-31-85 href=#__codelineno-31-85></a><span class=w>            </span><span class=no>This update is part of a coordinated update across all services.</span>
</span><span id=__span-31-86><a id=__codelineno-31-86 name=__codelineno-31-86 href=#__codelineno-31-86></a><span class=w>          </span><span class=nt>labels</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dependencies, automated</span>
</span><span id=__span-31-87><a id=__codelineno-31-87 name=__codelineno-31-87 href=#__codelineno-31-87></a><span class=w>          </span><span class=nt>commit-message</span><span class=p>:</span><span class=w> </span><span class=s>&quot;chore(deps):</span><span class=nv> </span><span class=s>update</span><span class=nv> </span><span class=s>${{</span><span class=nv> </span><span class=s>matrix.dependency</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>in</span><span class=nv> </span><span class=s>${{</span><span class=nv> </span><span class=s>matrix.service</span><span class=nv> </span><span class=s>}}&quot;</span>
</span></code></pre></div> <h3 id=air-gapped-environment-dependency-management>Air-gapped Environment Dependency Management<a class=headerlink href=#air-gapped-environment-dependency-management title="Permanent link">&para;</a></h3> <p>For secure environments without external network access:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=ch>#!/bin/bash</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=c1># Mirror dependencies for air-gapped environment</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=c1># Create directory structure</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>mkdir<span class=w> </span>-p<span class=w> </span>mirrors/npm
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>mkdir<span class=w> </span>-p<span class=w> </span>mirrors/pypi
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>mkdir<span class=w> </span>-p<span class=w> </span>mirrors/maven
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a><span class=c1># Mirror npm packages</span>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Mirroring npm packages...&quot;</span>
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span>package-lock.json<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a><span class=w>  </span><span class=c1># Extract package URLs</span>
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a><span class=w>  </span><span class=nv>NPM_URLS</span><span class=o>=</span><span class=k>$(</span>jq<span class=w> </span>-r<span class=w> </span><span class=s1>&#39;.packages | to_entries[] | select(.key != &quot;&quot;) | .value.resolved | select(. != null)&#39;</span><span class=w> </span>package-lock.json<span class=k>)</span>
</span><span id=__span-32-14><a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>
</span><span id=__span-32-15><a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a><span class=w>  </span><span class=c1># Download each package</span>
</span><span id=__span-32-16><a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a><span class=w>  </span><span class=k>for</span><span class=w> </span>URL<span class=w> </span><span class=k>in</span><span class=w> </span><span class=nv>$NPM_URLS</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-32-17><a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a><span class=w>    </span><span class=nv>FILENAME</span><span class=o>=</span><span class=k>$(</span>basename<span class=w> </span><span class=s2>&quot;</span><span class=nv>$URL</span><span class=s2>&quot;</span><span class=k>)</span>
</span><span id=__span-32-18><a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Downloading </span><span class=nv>$FILENAME</span><span class=s2>...&quot;</span>
</span><span id=__span-32-19><a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a><span class=w>    </span>curl<span class=w> </span>-s<span class=w> </span>-L<span class=w> </span>-o<span class=w> </span><span class=s2>&quot;mirrors/npm/</span><span class=nv>$FILENAME</span><span class=s2>&quot;</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$URL</span><span class=s2>&quot;</span>
</span><span id=__span-32-20><a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a><span class=w>  </span><span class=k>done</span>
</span><span id=__span-32-21><a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a><span class=k>fi</span>
</span><span id=__span-32-22><a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a>
</span><span id=__span-32-23><a id=__codelineno-32-23 name=__codelineno-32-23 href=#__codelineno-32-23></a><span class=c1># Mirror PyPI packages</span>
</span><span id=__span-32-24><a id=__codelineno-32-24 name=__codelineno-32-24 href=#__codelineno-32-24></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Mirroring PyPI packages...&quot;</span>
</span><span id=__span-32-25><a id=__codelineno-32-25 name=__codelineno-32-25 href=#__codelineno-32-25></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span>requirements.txt<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
</span><span id=__span-32-26><a id=__codelineno-32-26 name=__codelineno-32-26 href=#__codelineno-32-26></a><span class=w>  </span>pip<span class=w> </span>download<span class=w> </span>-r<span class=w> </span>requirements.txt<span class=w> </span>-d<span class=w> </span>mirrors/pypi
</span><span id=__span-32-27><a id=__codelineno-32-27 name=__codelineno-32-27 href=#__codelineno-32-27></a><span class=k>fi</span>
</span><span id=__span-32-28><a id=__codelineno-32-28 name=__codelineno-32-28 href=#__codelineno-32-28></a>
</span><span id=__span-32-29><a id=__codelineno-32-29 name=__codelineno-32-29 href=#__codelineno-32-29></a><span class=c1># Mirror Maven packages</span>
</span><span id=__span-32-30><a id=__codelineno-32-30 name=__codelineno-32-30 href=#__codelineno-32-30></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Mirroring Maven packages...&quot;</span>
</span><span id=__span-32-31><a id=__codelineno-32-31 name=__codelineno-32-31 href=#__codelineno-32-31></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span>pom.xml<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
</span><span id=__span-32-32><a id=__codelineno-32-32 name=__codelineno-32-32 href=#__codelineno-32-32></a><span class=w>  </span>mvn<span class=w> </span>dependency:go-offline<span class=w> </span>-Dmaven.repo.local<span class=o>=</span>./mirrors/maven
</span><span id=__span-32-33><a id=__codelineno-32-33 name=__codelineno-32-33 href=#__codelineno-32-33></a><span class=k>fi</span>
</span><span id=__span-32-34><a id=__codelineno-32-34 name=__codelineno-32-34 href=#__codelineno-32-34></a>
</span><span id=__span-32-35><a id=__codelineno-32-35 name=__codelineno-32-35 href=#__codelineno-32-35></a><span class=c1># Create mirror configuration files</span>
</span><span id=__span-32-36><a id=__codelineno-32-36 name=__codelineno-32-36 href=#__codelineno-32-36></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Creating mirror configurations...&quot;</span>
</span><span id=__span-32-37><a id=__codelineno-32-37 name=__codelineno-32-37 href=#__codelineno-32-37></a>
</span><span id=__span-32-38><a id=__codelineno-32-38 name=__codelineno-32-38 href=#__codelineno-32-38></a><span class=c1># npm</span>
</span><span id=__span-32-39><a id=__codelineno-32-39 name=__codelineno-32-39 href=#__codelineno-32-39></a>cat<span class=w> </span>&gt;<span class=w> </span>.npmrc<span class=w> </span><span class=s>&lt;&lt; EOL</span>
</span><span id=__span-32-40><a id=__codelineno-32-40 name=__codelineno-32-40 href=#__codelineno-32-40></a><span class=s>registry=file:./mirrors/npm</span>
</span><span id=__span-32-41><a id=__codelineno-32-41 name=__codelineno-32-41 href=#__codelineno-32-41></a><span class=s>offline=true</span>
</span><span id=__span-32-42><a id=__codelineno-32-42 name=__codelineno-32-42 href=#__codelineno-32-42></a><span class=s>EOL</span>
</span><span id=__span-32-43><a id=__codelineno-32-43 name=__codelineno-32-43 href=#__codelineno-32-43></a>
</span><span id=__span-32-44><a id=__codelineno-32-44 name=__codelineno-32-44 href=#__codelineno-32-44></a><span class=c1># pip</span>
</span><span id=__span-32-45><a id=__codelineno-32-45 name=__codelineno-32-45 href=#__codelineno-32-45></a>cat<span class=w> </span>&gt;<span class=w> </span>pip.conf<span class=w> </span><span class=s>&lt;&lt; EOL</span>
</span><span id=__span-32-46><a id=__codelineno-32-46 name=__codelineno-32-46 href=#__codelineno-32-46></a><span class=s>[global]</span>
</span><span id=__span-32-47><a id=__codelineno-32-47 name=__codelineno-32-47 href=#__codelineno-32-47></a><span class=s>no-index = true</span>
</span><span id=__span-32-48><a id=__codelineno-32-48 name=__codelineno-32-48 href=#__codelineno-32-48></a><span class=s>find-links = file://$(pwd)/mirrors/pypi</span>
</span><span id=__span-32-49><a id=__codelineno-32-49 name=__codelineno-32-49 href=#__codelineno-32-49></a><span class=s>EOL</span>
</span><span id=__span-32-50><a id=__codelineno-32-50 name=__codelineno-32-50 href=#__codelineno-32-50></a>
</span><span id=__span-32-51><a id=__codelineno-32-51 name=__codelineno-32-51 href=#__codelineno-32-51></a><span class=c1># maven</span>
</span><span id=__span-32-52><a id=__codelineno-32-52 name=__codelineno-32-52 href=#__codelineno-32-52></a>cat<span class=w> </span>&gt;<span class=w> </span>settings.xml<span class=w> </span><span class=s>&lt;&lt; EOL</span>
</span><span id=__span-32-53><a id=__codelineno-32-53 name=__codelineno-32-53 href=#__codelineno-32-53></a><span class=s>&lt;settings&gt;</span>
</span><span id=__span-32-54><a id=__codelineno-32-54 name=__codelineno-32-54 href=#__codelineno-32-54></a><span class=s>  &lt;mirrors&gt;</span>
</span><span id=__span-32-55><a id=__codelineno-32-55 name=__codelineno-32-55 href=#__codelineno-32-55></a><span class=s>    &lt;mirror&gt;</span>
</span><span id=__span-32-56><a id=__codelineno-32-56 name=__codelineno-32-56 href=#__codelineno-32-56></a><span class=s>      &lt;id&gt;local-mirror&lt;/id&gt;</span>
</span><span id=__span-32-57><a id=__codelineno-32-57 name=__codelineno-32-57 href=#__codelineno-32-57></a><span class=s>      &lt;url&gt;file://$(pwd)/mirrors/maven&lt;/url&gt;</span>
</span><span id=__span-32-58><a id=__codelineno-32-58 name=__codelineno-32-58 href=#__codelineno-32-58></a><span class=s>      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</span>
</span><span id=__span-32-59><a id=__codelineno-32-59 name=__codelineno-32-59 href=#__codelineno-32-59></a><span class=s>    &lt;/mirror&gt;</span>
</span><span id=__span-32-60><a id=__codelineno-32-60 name=__codelineno-32-60 href=#__codelineno-32-60></a><span class=s>  &lt;/mirrors&gt;</span>
</span><span id=__span-32-61><a id=__codelineno-32-61 name=__codelineno-32-61 href=#__codelineno-32-61></a><span class=s>&lt;/settings&gt;</span>
</span><span id=__span-32-62><a id=__codelineno-32-62 name=__codelineno-32-62 href=#__codelineno-32-62></a><span class=s>EOL</span>
</span><span id=__span-32-63><a id=__codelineno-32-63 name=__codelineno-32-63 href=#__codelineno-32-63></a>
</span><span id=__span-32-64><a id=__codelineno-32-64 name=__codelineno-32-64 href=#__codelineno-32-64></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Done creating mirror configuration&quot;</span>
</span></code></pre></div> <h2 id=dependency-management-maturity-model>Dependency Management Maturity Model<a class=headerlink href=#dependency-management-maturity-model title="Permanent link">&para;</a></h2> <p>Assess and improve your organization's dependency management practices using this maturity model:</p> <table> <thead> <tr> <th>Level</th> <th>Name</th> <th>Characteristics</th> <th>Example Practices</th> </tr> </thead> <tbody> <tr> <td><strong>1</strong></td> <td><strong>Ad-hoc</strong></td> <td>Manual, reactive dependency management</td> <td>Occasional manual updates, security fixes only after incidents</td> </tr> <tr> <td><strong>2</strong></td> <td><strong>Aware</strong></td> <td>Basic processes and tools implemented</td> <td>Regular updates, vulnerability scanning, simple policies</td> </tr> <tr> <td><strong>3</strong></td> <td><strong>Defined</strong></td> <td>Formalized processes, automated tools</td> <td>CI/CD integration, comprehensive policies, standard tools</td> </tr> <tr> <td><strong>4</strong></td> <td><strong>Managed</strong></td> <td>Measured, controlled dependency management</td> <td>Metrics-driven approach, risk scoring, proactive updates</td> </tr> <tr> <td><strong>5</strong></td> <td><strong>Optimizing</strong></td> <td>Continuous improvement, advanced techniques</td> <td>Advanced verification, contribution strategy, influence on upstream</td> </tr> </tbody> </table> <h3 id=level-5-optimizing-practices>Level 5 (Optimizing) Practices<a class=headerlink href=#level-5-optimizing-practices title="Permanent link">&para;</a></h3> <p>Organizations at the highest maturity level implement practices like:</p> <ol> <li><strong>Upstream Contribution Strategy</strong></li> </ol> <div class="language-markdown highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=gh># Upstream Contribution Strategy</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=gu>## Goals</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=k>-</span><span class=w> </span>Reduce dependency risks by improving upstream security
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=k>-</span><span class=w> </span>Ensure long-term maintenance of critical dependencies
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=k>-</span><span class=w> </span>Build organizational reputation in open source communities
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=gu>## Contribution Tiers</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=k>1.</span> <span class=gs>**Critical Dependencies**</span>
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Assign dedicated maintainer time (20%)
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Regular security audits &amp; fixes
</span><span id=__span-33-12><a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Financial support/sponsorship
</span><span id=__span-33-13><a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>
</span><span id=__span-33-14><a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a><span class=k>2.</span> <span class=gs>**High-Impact Dependencies**</span>
</span><span id=__span-33-15><a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Regular contributions (bug fixes, features)
</span><span id=__span-33-16><a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Security vulnerability reporting
</span><span id=__span-33-17><a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Participation in design discussions
</span><span id=__span-33-18><a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a>
</span><span id=__span-33-19><a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a><span class=k>3.</span> <span class=gs>**Standard Dependencies**</span>
</span><span id=__span-33-20><a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Issue reporting
</span><span id=__span-33-21><a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Occasional PRs for needed fixes
</span><span id=__span-33-22><a id=__codelineno-33-22 name=__codelineno-33-22 href=#__codelineno-33-22></a><span class=w>   </span><span class=k>-</span><span class=w> </span>Documentation improvements
</span><span id=__span-33-23><a id=__codelineno-33-23 name=__codelineno-33-23 href=#__codelineno-33-23></a>
</span><span id=__span-33-24><a id=__codelineno-33-24 name=__codelineno-33-24 href=#__codelineno-33-24></a><span class=gu>## Process</span>
</span><span id=__span-33-25><a id=__codelineno-33-25 name=__codelineno-33-25 href=#__codelineno-33-25></a><span class=k>1.</span> Identify strategic dependencies quarterly
</span><span id=__span-33-26><a id=__codelineno-33-26 name=__codelineno-33-26 href=#__codelineno-33-26></a><span class=k>2.</span> Allocate engineering resources
</span><span id=__span-33-27><a id=__codelineno-33-27 name=__codelineno-33-27 href=#__codelineno-33-27></a><span class=k>3.</span> Track contribution metrics
</span><span id=__span-33-28><a id=__codelineno-33-28 name=__codelineno-33-28 href=#__codelineno-33-28></a><span class=k>4.</span> Report impact to leadership
</span></code></pre></div> <ol> <li><strong>Advanced Verification Techniques</strong></li> </ol> <div class="language-python highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=c1># Example reproducible build verification</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=kn>import</span> <span class=nn>os</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=kn>import</span> <span class=nn>json</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=kn>import</span> <span class=nn>subprocess</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=kn>import</span> <span class=nn>hashlib</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=k>def</span> <span class=nf>verify_package_integrity</span><span class=p>(</span><span class=n>package_name</span><span class=p>,</span> <span class=n>version</span><span class=p>,</span> <span class=n>expected_hash</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Verify package integrity through reproducible build.&quot;&quot;&quot;</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Verifying </span><span class=si>{</span><span class=n>package_name</span><span class=si>}</span><span class=s2>@</span><span class=si>{</span><span class=n>version</span><span class=si>}</span><span class=s2>...&quot;</span><span class=p>)</span>
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>    <span class=c1># Create temporary build environment</span>
</span><span id=__span-34-12><a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>    <span class=n>build_dir</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;./verify-builds/</span><span class=si>{</span><span class=n>package_name</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-34-13><a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a>    <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>build_dir</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-34-14><a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>
</span><span id=__span-34-15><a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>    <span class=c1># Clone source</span>
</span><span id=__span-34-16><a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>    <span class=n>repo_url</span> <span class=o>=</span> <span class=n>get_repository_url</span><span class=p>(</span><span class=n>package_name</span><span class=p>)</span>
</span><span id=__span-34-17><a id=__codelineno-34-17 name=__codelineno-34-17 href=#__codelineno-34-17></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>repo_url</span><span class=p>:</span>
</span><span id=__span-34-18><a id=__codelineno-34-18 name=__codelineno-34-18 href=#__codelineno-34-18></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot; Could not determine repository URL for </span><span class=si>{</span><span class=n>package_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-19><a id=__codelineno-34-19 name=__codelineno-34-19 href=#__codelineno-34-19></a>        <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-34-20><a id=__codelineno-34-20 name=__codelineno-34-20 href=#__codelineno-34-20></a>
</span><span id=__span-34-21><a id=__codelineno-34-21 name=__codelineno-34-21 href=#__codelineno-34-21></a>    <span class=c1># Clone at specific version</span>
</span><span id=__span-34-22><a id=__codelineno-34-22 name=__codelineno-34-22 href=#__codelineno-34-22></a>    <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span>
</span><span id=__span-34-23><a id=__codelineno-34-23 name=__codelineno-34-23 href=#__codelineno-34-23></a>        <span class=s2>&quot;git&quot;</span><span class=p>,</span> <span class=s2>&quot;clone&quot;</span><span class=p>,</span> <span class=n>repo_url</span><span class=p>,</span> <span class=n>build_dir</span>
</span><span id=__span-34-24><a id=__codelineno-34-24 name=__codelineno-34-24 href=#__codelineno-34-24></a>    <span class=p>],</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-34-25><a id=__codelineno-34-25 name=__codelineno-34-25 href=#__codelineno-34-25></a>
</span><span id=__span-34-26><a id=__codelineno-34-26 name=__codelineno-34-26 href=#__codelineno-34-26></a>    <span class=c1># Checkout version</span>
</span><span id=__span-34-27><a id=__codelineno-34-27 name=__codelineno-34-27 href=#__codelineno-34-27></a>    <span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=n>build_dir</span><span class=p>)</span>
</span><span id=__span-34-28><a id=__codelineno-34-28 name=__codelineno-34-28 href=#__codelineno-34-28></a>    <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span>
</span><span id=__span-34-29><a id=__codelineno-34-29 name=__codelineno-34-29 href=#__codelineno-34-29></a>        <span class=s2>&quot;git&quot;</span><span class=p>,</span> <span class=s2>&quot;checkout&quot;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;v</span><span class=si>{</span><span class=n>version</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-34-30><a id=__codelineno-34-30 name=__codelineno-34-30 href=#__codelineno-34-30></a>    <span class=p>],</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-34-31><a id=__codelineno-34-31 name=__codelineno-34-31 href=#__codelineno-34-31></a>
</span><span id=__span-34-32><a id=__codelineno-34-32 name=__codelineno-34-32 href=#__codelineno-34-32></a>    <span class=c1># Build package in controlled environment</span>
</span><span id=__span-34-33><a id=__codelineno-34-33 name=__codelineno-34-33 href=#__codelineno-34-33></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Building from source...&quot;</span><span class=p>)</span>
</span><span id=__span-34-34><a id=__codelineno-34-34 name=__codelineno-34-34 href=#__codelineno-34-34></a>    <span class=n>build_result</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span>
</span><span id=__span-34-35><a id=__codelineno-34-35 name=__codelineno-34-35 href=#__codelineno-34-35></a>        <span class=s2>&quot;docker&quot;</span><span class=p>,</span> <span class=s2>&quot;run&quot;</span><span class=p>,</span> <span class=s2>&quot;--rm&quot;</span><span class=p>,</span>
</span><span id=__span-34-36><a id=__codelineno-34-36 name=__codelineno-34-36 href=#__codelineno-34-36></a>        <span class=s2>&quot;-v&quot;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span><span class=si>}</span><span class=s2>:/build&quot;</span><span class=p>,</span>
</span><span id=__span-34-37><a id=__codelineno-34-37 name=__codelineno-34-37 href=#__codelineno-34-37></a>        <span class=s2>&quot;reproducible-build-env:latest&quot;</span><span class=p>,</span>
</span><span id=__span-34-38><a id=__codelineno-34-38 name=__codelineno-34-38 href=#__codelineno-34-38></a>        <span class=s2>&quot;/bin/sh&quot;</span><span class=p>,</span> <span class=s2>&quot;-c&quot;</span><span class=p>,</span> <span class=s2>&quot;cd /build &amp;&amp; npm ci &amp;&amp; npm run build&quot;</span>
</span><span id=__span-34-39><a id=__codelineno-34-39 name=__codelineno-34-39 href=#__codelineno-34-39></a>    <span class=p>],</span> <span class=n>capture_output</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-34-40><a id=__codelineno-34-40 name=__codelineno-34-40 href=#__codelineno-34-40></a>
</span><span id=__span-34-41><a id=__codelineno-34-41 name=__codelineno-34-41 href=#__codelineno-34-41></a>    <span class=k>if</span> <span class=n>build_result</span><span class=o>.</span><span class=n>returncode</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-34-42><a id=__codelineno-34-42 name=__codelineno-34-42 href=#__codelineno-34-42></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot; Build failed: </span><span class=si>{</span><span class=n>build_result</span><span class=o>.</span><span class=n>stderr</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-43><a id=__codelineno-34-43 name=__codelineno-34-43 href=#__codelineno-34-43></a>        <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-34-44><a id=__codelineno-34-44 name=__codelineno-34-44 href=#__codelineno-34-44></a>
</span><span id=__span-34-45><a id=__codelineno-34-45 name=__codelineno-34-45 href=#__codelineno-34-45></a>    <span class=c1># Calculate hash of built package</span>
</span><span id=__span-34-46><a id=__codelineno-34-46 name=__codelineno-34-46 href=#__codelineno-34-46></a>    <span class=n>built_package_path</span> <span class=o>=</span> <span class=s2>&quot;./dist/package.tgz&quot;</span>
</span><span id=__span-34-47><a id=__codelineno-34-47 name=__codelineno-34-47 href=#__codelineno-34-47></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>built_package_path</span><span class=p>):</span>
</span><span id=__span-34-48><a id=__codelineno-34-48 name=__codelineno-34-48 href=#__codelineno-34-48></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot; Built package not found at </span><span class=si>{</span><span class=n>built_package_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-49><a id=__codelineno-34-49 name=__codelineno-34-49 href=#__codelineno-34-49></a>        <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-34-50><a id=__codelineno-34-50 name=__codelineno-34-50 href=#__codelineno-34-50></a>
</span><span id=__span-34-51><a id=__codelineno-34-51 name=__codelineno-34-51 href=#__codelineno-34-51></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>built_package_path</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-34-52><a id=__codelineno-34-52 name=__codelineno-34-52 href=#__codelineno-34-52></a>        <span class=n>built_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span><span id=__span-34-53><a id=__codelineno-34-53 name=__codelineno-34-53 href=#__codelineno-34-53></a>
</span><span id=__span-34-54><a id=__codelineno-34-54 name=__codelineno-34-54 href=#__codelineno-34-54></a>    <span class=c1># Compare with expected hash</span>
</span><span id=__span-34-55><a id=__codelineno-34-55 name=__codelineno-34-55 href=#__codelineno-34-55></a>    <span class=k>if</span> <span class=n>expected_hash</span><span class=p>:</span>
</span><span id=__span-34-56><a id=__codelineno-34-56 name=__codelineno-34-56 href=#__codelineno-34-56></a>        <span class=k>if</span> <span class=n>built_hash</span> <span class=o>==</span> <span class=n>expected_hash</span><span class=p>:</span>
</span><span id=__span-34-57><a id=__codelineno-34-57 name=__codelineno-34-57 href=#__codelineno-34-57></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot; Package hash matches expected: </span><span class=si>{</span><span class=n>built_hash</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-58><a id=__codelineno-34-58 name=__codelineno-34-58 href=#__codelineno-34-58></a>            <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-34-59><a id=__codelineno-34-59 name=__codelineno-34-59 href=#__codelineno-34-59></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-34-60><a id=__codelineno-34-60 name=__codelineno-34-60 href=#__codelineno-34-60></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot; Hash mismatch! Expected: </span><span class=si>{</span><span class=n>expected_hash</span><span class=si>}</span><span class=s2>, Got: </span><span class=si>{</span><span class=n>built_hash</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-61><a id=__codelineno-34-61 name=__codelineno-34-61 href=#__codelineno-34-61></a>            <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-34-62><a id=__codelineno-34-62 name=__codelineno-34-62 href=#__codelineno-34-62></a>
</span><span id=__span-34-63><a id=__codelineno-34-63 name=__codelineno-34-63 href=#__codelineno-34-63></a>    <span class=c1># If no expected hash, compare with published version</span>
</span><span id=__span-34-64><a id=__codelineno-34-64 name=__codelineno-34-64 href=#__codelineno-34-64></a>    <span class=n>published_package</span> <span class=o>=</span> <span class=n>get_published_package</span><span class=p>(</span><span class=n>package_name</span><span class=p>,</span> <span class=n>version</span><span class=p>)</span>
</span><span id=__span-34-65><a id=__codelineno-34-65 name=__codelineno-34-65 href=#__codelineno-34-65></a>    <span class=n>published_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>published_package</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span><span id=__span-34-66><a id=__codelineno-34-66 name=__codelineno-34-66 href=#__codelineno-34-66></a>
</span><span id=__span-34-67><a id=__codelineno-34-67 name=__codelineno-34-67 href=#__codelineno-34-67></a>    <span class=k>if</span> <span class=n>built_hash</span> <span class=o>==</span> <span class=n>published_hash</span><span class=p>:</span>
</span><span id=__span-34-68><a id=__codelineno-34-68 name=__codelineno-34-68 href=#__codelineno-34-68></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot; Built package matches published package: </span><span class=si>{</span><span class=n>built_hash</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-69><a id=__codelineno-34-69 name=__codelineno-34-69 href=#__codelineno-34-69></a>        <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-34-70><a id=__codelineno-34-70 name=__codelineno-34-70 href=#__codelineno-34-70></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-34-71><a id=__codelineno-34-71 name=__codelineno-34-71 href=#__codelineno-34-71></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot; Hash mismatch! Published: </span><span class=si>{</span><span class=n>published_hash</span><span class=si>}</span><span class=s2>, Built: </span><span class=si>{</span><span class=n>built_hash</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-72><a id=__codelineno-34-72 name=__codelineno-34-72 href=#__codelineno-34-72></a>        <span class=c1># Store diff for analysis</span>
</span><span id=__span-34-73><a id=__codelineno-34-73 name=__codelineno-34-73 href=#__codelineno-34-73></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>package_name</span><span class=si>}</span><span class=s2>-</span><span class=si>{</span><span class=n>version</span><span class=si>}</span><span class=s2>-diff.log&quot;</span><span class=p>,</span> <span class=s2>&quot;w&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-34-74><a id=__codelineno-34-74 name=__codelineno-34-74 href=#__codelineno-34-74></a>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Published hash: </span><span class=si>{</span><span class=n>published_hash</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-75><a id=__codelineno-34-75 name=__codelineno-34-75 href=#__codelineno-34-75></a>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Built hash: </span><span class=si>{</span><span class=n>built_hash</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-34-76><a id=__codelineno-34-76 name=__codelineno-34-76 href=#__codelineno-34-76></a>        <span class=k>return</span> <span class=kc>False</span>
</span></code></pre></div> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">&para;</a></h2> <p>Dependency management is a critical aspect of software supply chain security that requires continuous attention and proactive measures. By implementing the strategies outlined in this guide, organizations can significantly reduce the risk of supply chain attacks and vulnerabilities introduced through third-party dependencies.</p> <p>Remember that dependency management is not a one-time activity but an ongoing process that should be integrated into your development lifecycle. Regular audits, updates, and monitoring are essential components of a robust dependency management strategy.</p> <p>As you mature your dependency management practices, focus on automation, comprehensive policies, and developer education to create a secure and sustainable approach to third-party code.</p> <div class="admonition tip"> <p class=admonition-title>Getting Started</p> <ol> <li>Start by creating a complete inventory of your dependencies</li> <li>Implement basic vulnerability scanning</li> <li>Establish simple dependency policies</li> <li>Integrate scanning into your CI/CD pipeline</li> <li>Gradually improve processes based on lessons learned</li> </ol> <p>The most important step is to begin treating dependencies as first-class citizens in your security program rather than an afterthought.</p> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="May 18, 2025 12:50:18">May 18, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="May 18, 2025 08:34:59">May 18, 2025</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../risk-assessment/vulnerability-management/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Vulnerability Management"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Vulnerability Management </div> </div> </a> <a href=../sbom/ class="md-footer__link md-footer__link--next" aria-label="Next: SBOM"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> SBOM </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight>  2023-2025 Software Supply Chain Security </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/harekrishnarai target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://twitter.com/harekrishnarai target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your preferences and analyze site traffic. We never collect any personal data or information other than technical data for performance.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer", "navigation.expand", "toc.follow", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link", "header.autohide"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.13a4f30d.min.js></script> <script src=../../assets/extra.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>